(function(a){var d=null,g=null,c=function(o,k,q){var t,r,p,n;if(!o){return null}q=q||false;if(typeof o==="object"){return o}t=o.split(".");n=a;if(t.length===1&&k&&k[o]){return k[o]}for(r=0,p=t.length;r<p;r++){n=n[t[r]];if(n===undefined){if(g){try{var u=g(o,k);if(u){return u}}catch(s){return null}}else{return null}}}if(q||n.namespace!==undefined){return n}return null},b=function(n,r,q){var t=typeof r==="boolean",p=t?r:false,s,k=(t?q:r)||{},s=n.split("."),u=s.pop(),o;if(!n.match(/^[A-Za-z0-9.]*$/)){return j.ThrowError(100,null,{namespace:n})}o=s.length?f(s):a;if(o[u]!==undefined){return o[u]}return o[u]=p?new k():k},f=function(p){var o=a,n,k;for(n=0,k=p.length;n<k;n++){if(!o[p[n]]){o[p[n]]={}}o=o[p[n]]}return o},e=function(){d={};for(var k in a){d[k]=""}},h=function(k){if(!d){j.ThrowError(101)}else{var o=[],n;for(n in a){if(d[n]===undefined){o.push(n)}}if(k===true){e()}return o}};var j=a.a5={version:function(){return"0.5.{BUILD_NUMBER}"},buildDate:function(){return"{BUILD_DATE}"},GetNamespace:c,SetNamespace:b,TrackGlobalStrays:e,GetGlobalStrays:h,_a5_destroyedObj:{},_a5_destroyedObjFunc:function(){var k=arguments.callee.caller,n="Destroyed method called from";if(k._a5_methodName!==undefined){throw n+" method '"+k.getName()+"' in class '"+k.getClass().className()+"'"}else{throw n+" function '"+k.toString()+"'"}},_a5_classCreateHandler:function(){return classCreateHandler},CreateGlobals:function(){a.Create=j.Create;a.Package=j.Package;a.GetNamespace=j.GetNamespace;a.SetNamespace=j.SetNamespace;a.ThrowError=j.ThrowError},RegisterNamespaceResolver:function(k){g=k}};j.SetNamespace("a5.core.reflection",true,function(){var k={getName:function(){return this._a5_methodName},getClass:function(){return this._a5_ownerClass},getClassInstance:function(){return this._a5_ownerInstance},getAttributes:function(){return this._a5_attributes?this._a5_attributes:null}},n=function(o,q,r,p){p=p||q[r];p._a5_ownerInstance=q;p._a5_ownerClass=o;p._a5_methodName=r;p.getName=k.getName;p.getClass=k.getClass;p.getClassInstance=k.getClassInstance;p.getAttributes=k.getAttributes};return{setReflection:n}});j.SetNamespace("a5.core.attributes",true,function(){var o=function(r,u){var y=Array.prototype.slice.call(u),v,H,G,F,E,z,w={},p=false;if(!y.length){return j.ThrowError(305)}v=typeof y[y.length-1]==="function"?y.pop():null;if(v!==null&&typeof v!=="function"){return j.ThrowError(300)}if(!y.length){return j.ThrowError(301)}for(H=0,E=y.length;H<E;H++){var x=y[H];if(Object.prototype.toString.call(x)!=="[object Array]"){return j.ThrowError(302)}for(G=0,F=x.length;G<F;G++){var C=x[G],z=typeof C;if(G==0){var I=false,D=null;if(z!=="string"){if(z==="function"){D=C}else{I=true}}else{var s=j.GetNamespace(C,r.imports());if(!s){s=j.GetNamespace(C+"Attribute",r.imports())}if(s){D=x[G]=s}else{I=true}}if(!I&&(!D.isA5||!D.doesExtend(j.Attribute))){I=true}else{if(D.doesExtend(j.AspectAttribute)){p=true}}if(I){return j.ThrowError(303)}}else{if(z!=="object"||Object.prototype.toString.call(C)==="[object Array]"){return j.ThrowError(304)}}}}for(H=0,E=y.length;H<E;H++){var q=y[H],B=[];for(var G=1,F=q.length;G<F;G++){B.push(q[G])}y[H]=[q[0],B];w[q[0].className()]=B}if(!p){if(!v){v=function(){}}v._a5_attributes=w;return v}w.wrappedMethod=v;var A=function(){var N,J,L,V=[],R=this,N,P=0;if(v){for(var J in A){v[J]=A[J]}}L=A.caller;do{if(L.getClassInstance!==undefined){N=L}else{L=L.caller}}while(L!==null&&!N);for(var O=0,M=y.length;O<M;O++){var U=y[O][0],T=U.instance(true),S=y[O][1];V.push({cls:T,props:S})}var Q=function(Y,X,W){K(P,Y,X,W)},K=function(X,ac,ae,Y){if(ac){if(Object.prototype.toString.call(ac)!=="[object Array]"){ac=[ac]}}else{ac=[]}if(!Y){Y=ac}if(X>=V.length){if(ae){return ac[0]}else{return t(ac,Y)}}var ab,ae=ae||false,aa=false,Z=false,ad=function(af){Q.call(this,af||ac,ae,Y)};var W=j.Create(j.AspectCallArguments,[V[X].props,ac,R,A,ad,N,Y]);ab=V[X].cls.around(W);if(ab===j.AspectAttribute.NOT_IMPLEMENTED){ab=V[X].cls[(ae?"after":"before")](W)}else{aa=true}if(ab!==null&&ab!==undefined){switch(ab){case j.AspectAttribute.NOT_IMPLEMENTED:case j.Attribute.SUCCESS:ab=ac;break;case j.Attribute.ASYNC:Z=true;break;case j.Attribute.RETURN_NULL:ab=null;break;case j.Attribute.FAILURE:return}}else{return j.ThrowError(308,null,{prop:J,method:aa?"around":(ae?"after":"before")})}P=X+1;if(!Z){return K(P,ab,ae,ac,Y)}},t=function(X,W){P=0;var Y=v?v.apply(R,X):undefined;if(Y!==undefined){Y=[Y]}else{Y=X}return K(0,Y,true,W)};return K(P,Array.prototype.slice.call(arguments))};A._a5_attributes=w;return A},n=function(){for(i=0,l=j.Attribute._extenderRef.length;i<l;i++){j.Create(j.Attribute._extenderRef[i])}},k=function(y,w){var x=w.split("|");for(var u=0,s=x.length;u<s;u++){var p=x[u],q=p.charAt(0)==="*",z=p.charAt(p.length-1)==="*",v=y.indexOf(p),t=v!==-1;if(t){return true}if(q&&y.indexOf(p.substr(1))===0){return true}if(z&&y.indexOf(p.substr(0,p.length-1))>-1){return true}}return false};applyClassAttribs=function(F,r){var t=F.getMethods(),D=Array.prototype.slice;for(var A=0,u=t.length;A<u;A++){var E=t[A],p=F[E],s=[];for(var y=0,v=r.length;y<v;y++){var C=D.call(r[y]);if(C.length>1){var z=C[C.length-1],q=false,x=true,w=z.include,B=z.exclude;if(w!==undefined){q=true;if(typeof w==="object"){x=E.match(w).length>0}else{x=k(E,w)}}if(B!==undefined){q=true;if(typeof B==="object"){x=E.match(B)}else{x=k(E,B)}}if(q){C.pop()}if(x){s.push(C)}}else{s.push(C)}}if(s.length){s.push(p);F[E]=j.core.attributes.createAttribute(F,s);j.core.reflection.setReflection(F.constructor,F,E,F[E])}}};return{createAttribute:o,applyClassAttribs:applyClassAttribs}});j.SetNamespace("a5.core.classBuilder",true,function(){var v=[],z=false,q=[],u=[],k,s=function(B,A){var C,D;if(typeof B==="string"){C=j.GetNamespace(B);if(C===null){return j.ThrowError(207,null,{className:B})}}else{C=B}if(typeof C!=="function"){return j.ThrowError(207,null,{className:B})}if(C.isInterface()){return j.ThrowError(208,null,{nm:C.namespace()})}try{D=new C()}catch(E){return j.ThrowError(209,null,{nm:typeof B==="string"?B:(B.namespace?B.namespace():""),errorStr:E})}if(C._a5_clsDef){y(C._a5_clsDef,D,D,C.imports(),C)}D._a5_initialize(A);return D},y=function(A,D,F,B,C,E){if(E){D.Properties=function(G){F.constructor._a5_protoProps=G};D.PrivateProperties=function(G){F.constructor._a5_protoPrivateProps=G;return function(H){return H._a5_privatePropsRef[F.namespace()]}}}D.Attributes=function(){return j.core.attributes.createAttribute.call(F,D,arguments)};F.Override={};F.Final={};A.call(D,F,B,C);j.core.mixins.prepareMixins(F);w(F);for(k in F){if(k!=="Attributes"&&({}).hasOwnProperty.call(F,k)&&typeof F[k]==="function"&&(C._a5_namespace==="a5.Object"||j.core.classProxyObj.instance[k]===undefined)){if(k===F.className()){F.constructor._a5_instanceConst=F[k];j.core.reflection.setReflection(C,F,k,F.constructor._a5_instanceConst);delete F[k]}else{j.core.reflection.setReflection(C,F,k)}}}delete F.Final;delete F.Override;delete D.Attributes;if(E){delete D.Properties;delete D.PrivateProperties}},w=function(C){var D=C.superclass(),A=C.constructor._a5_mixedMethods;if(!D){D={}}for(k in C){if(C.hasOwnProperty(k)&&typeof C[k]==="function"){if(k!=="Final"&&k!=="Override"&&k!=="constructor"&&k!=="prototype"&&k!=="dealloc"&&k!=="_a5_initialized"){if(D[k]&&D[k].toString().indexOf("[native code]")===-1){if(D[k].Final==true){return j.ThrowError(201,null,{prop:k,namespace:C.namespace()})}return j.ThrowError(200,null,{prop:k,namespace:C.namespace()})}else{var B=A[k];if(A[k]!==undefined&&B!==C[k]){return j.ThrowError(220,null,{prop:k,namespace:C.namespace()})}}}}}for(k in C.Override){if(D[k]===undefined&&A[k]===undefined){return j.ThrowError(202,null,{prop:k,namespace:C.namespace()})}if(D[k]&&D[k].Final===true||A[k]&&A[k].Final===true){return j.ThrowError(203,null,{prop:k,namespace:C.namespace()})}C[k]=C.Override[k]}for(k in C.Final){C[k]=C.Final[k];C[k].Final=true}},t=function(E){var X,K,A,F,D,N,H,B,L=null,G=false,V=false,I=false,R=false,Q=false,M=function(){var aa=o(X,E),ac={pkg:E,imports:X,clsName:K,cls:A,base:F,attribs:L,type:D,proto:N,implement:H,mixins:B,staticMethods:G,isInterface:I,isMixin:V,enumDeclaration:R,isProto:Q},ab=j.core.verifiers.validateClassDependencies(F,aa,B,H,I,V);if(ab===true){p(ac)}else{v.push({pkg:ac,reason:ab.reason,reasonNM:ab.reasonNM})}M=J=W=T=Y=C=S=P=Z=U=O=null},J=function(){X=Array.prototype.slice.call(arguments);return{Prototype:P,Static:Y,Mixin:Z,Mix:U,Extends:W,Implements:T,Interface:C,Class:S}},W=function(aa){F=aa;return{Prototype:P,Static:Y,Import:J,Mix:U,Implements:T,Interface:C,Class:S}},U=function(){B=Array.prototype.slice.call(arguments);return{Prototype:P,Static:Y,Extends:W,Implements:T,Interface:C,Class:S}},T=function(aa){H=Array.prototype.slice.call(arguments);return{Prototype:P,Static:Y,Mix:U,Import:J,Extends:W,Class:S}},Y=function(aa,ab){if(typeof aa==="string"){K=aa;G=ab;M()}else{G=aa;return{Prototype:P,Implements:T,Mix:U,Mixin:Z,Import:J,Extends:W,Class:S}}},C=function(ab,aa){K=ab;A=aa;I=true;M()},Z=function(){V=true;var ab=Array.prototype.slice.call(arguments);K=ab[0];for(var ac=1,aa=ab.length;ac<aa;ac++){switch(typeof ab[ac]){case"string":D=ab[ac];break;case"object":if(Object.prototype.toString.call(ab[ac])==="[object Array]"){if(!L){L=[]}L.push(ab[ac])}break;case"function":A=ab[ac];break}}M()},O=function(aa,ab){K=aa;R=ab;M()},S=function(){var ab=Array.prototype.slice.call(arguments);K=ab[0];for(var ac=1,aa=ab.length;ac<aa;ac++){switch(typeof ab[ac]){case"string":D=ab[ac];break;case"object":if(Object.prototype.toString.call(ab[ac])==="[object Array]"){if(!L){L=[]}L.push(ab[ac])}break;case"function":A=ab[ac];break}}M()},P=function(){Q=true;var ab=Array.prototype.slice.call(arguments);K=ab[0];for(var ac=1,aa=ab.length;ac<aa;ac++){switch(typeof ab[ac]){case"string":D=ab[ac];break;case"object":if(Object.prototype.toString.call(ab[ac])==="[object Array]"){if(!L){L=[]}L.push(ab[ac])}break;case"function":N=ab[ac];break}}M()};j.SetNamespace(E);return{Enum:O,Static:Y,Import:J,Extends:W,Mixin:Z,Mix:U,Implements:T,Class:S,Prototype:P,Interface:C}},x=function(L,G,O,C,J,S,V,A,N){if(J){if(G&&!G.isInterface()){return j.ThrowError('Interface "'+L+'" cannot extend "'+G.namespace()+'", base class is not an interface.')}G=null}var B=function(){},H=S===false||false,W=false,K=false,R=null,Q=L.lastIndexOf("."),D=Q>-1?L.substring(0,Q):"",M=Q>-1?L.substring(Q+1):L,F,I,E,X,U,P;if(!G||G===undefined){G=(L=="a5.Object"?B:j.Object)}I=function(){};if(C){F=C.split(/[ |]/);for(U=0,P=F.length;U<P;U++){if(F[U]=="final"){H=true}else{if(F[U]=="singleton"){W=true}else{if(F[U]=="abstract"){K=true}}}}}if(j.core.verifiers.checkNamespaceValid(L)){if(!G.isFinal||(G.isFinal()!=true)){if(G===Error){var T={};T.prototype=new G();I.prototype=T;T=null}else{I.prototype=new G()}R=G}else{return j.ThrowError("Cannot extend "+G.namespace()+", class marked as final.")}}else{return j.ThrowError("Cannot create new class in namespace "+L+", definition already exists.")}E=I.prototype;X=E.constructor=I;if(G.prototype.constructor._extenderRef){G.prototype.constructor._extenderRef.push(I)}X._a5_superclass=R;X._a5_pkg=D;X._a5_clsDef=O;X._a5_clsName=M;X._a5_namespace=L;X._a5_imports=V;X._a5_isFinal=H;X._a5_isAbstract=K;X._a5_isSingleton=W;X._a5_isInterface=J;X._a5_isPrototype=S||false;X._a5_attribs=N;X._mixinRef=G.prototype.constructor._mixinRef?G.prototype.constructor._mixinRef.slice(0):[];X._implementsRef=G.prototype.constructor._implementsRef?G.prototype.constructor._implementsRef.slice(0):[];X._a5_mixedMethods={};X._a5_instance=null;X._instanceCount=0;X._extenderRef=[];E._a5_initialized=false;for(k in j.core.classProxyObj.construct){X[k]=j.core.classProxyObj.construct[k]}if(G.namespace===undefined){for(k in j.core.classProxyObj.instance){E[k]=j.core.classProxyObj.instance[k]}}if(A){j.core.mixins.applyMixins(E,A,V)}return j.SetNamespace(L,I)},r=function(){var A=false,E,C;for(E=0;E<v.length;E++){var F=v[E].pkg,B=o(F.imports,F.pkg),D=j.core.verifiers.validateClassDependencies(F.base,B,F.mixins,F.implement);if(D===true){p(F,true);v.splice(E,1);E--;A=true}else{v[E].reason=D.reason;v[E].reasonNM=D.reasonNM}}if(A){r()}},n=function(C){var B=C.obj,A=C.pkgObj;y(A.proto,B,B.prototype,B.imports(),B,true)},p=function(H,D){var A=function(){return o(H.imports,H.pkg)},B=(typeof H.base==="function")?H.base:j.GetNamespace(H.base,A()),E=x(H.pkg+"."+H.clsName,B,H.cls,H.type,H.isInterface,H.isProto,A,H.mixins,H.attribs),I=D||false,L=true,F,C;if(H.staticMethods){H.staticMethods(E,A())}if(H.proto&&z){q.push({obj:E,pkgObj:H});if(H.implement){u.push({pkgObj:H,obj:E})}}else{if(H.proto){n({obj:E,pkgObj:H})}if(H.implement){L=j.core.verifiers.validateImplementation(H,E)}}if(!L){return}if(H.enumDeclaration){var G=0,J=[];H.enumDeclaration({startIndex:function(M){G=M},addValue:function(M){J.push(M)}});for(F=0,C=J.length;F<C;F++){E[J[F]]=G++}E.addValue=function(M){if(E[M]===undefined){E[M]=G++}};E.getValue=function(M){for(k in E){if(E[k]===M){return k}}return null}}if(H.isInterface){E.interfaceVals={};if(H.base!==null&&H.base!==undefined){var K=j.GetNamespace(H.base,E.imports());if(K.isInterface()){for(k in K.interfaceVals){if(E.interfaceVals[k]===undefined){E.interfaceVals[k]=K.interfaceVals[k]}}}else{j.ThrowError(204,null,{objNM:E.namespace(),clsNM:K.namespace()})}}H.cls.call(E.interfaceVals,E.interfaceVals)}if(H.isMixin){E._mixinDef={Properties:function(M){E.prototype.constructor._a5_mixinProps=M},MustExtend:function(){E.prototype.constructor._a5_mixinMustExtend=arguments},MustMix:function(){E.prototype.constructor._a5_mixinMustMix=arguments}};H.cls.call(E._mixinDef,E._mixinDef,E.imports(),E);if(typeof E._mixinDef[E.className()]==="function"){E._a5_instanceConst=E._mixinDef[E.className()];delete E._mixinDef[E.className()]}else{j.ThrowError(205,null,{nm:E.namespace()})}delete E._mixinDef.Properties;delete E._mixinDef.Contract;delete E._mixinDef.MustExtend;delete E._mixinDef.MustMix}if(!I){r()}},o=function(C,B,A){return(function(K,M){var H=function(){if(E.length){var P={},R=o(E,null,true),O=R.retObj,Q=R.rebuildArray;for(k in H){P[k]=H[k]}for(k in O){if(P[k]===undefined){H[k]=P[k]=O[k]}}E=Q;return P}else{return H}},D=A||false,E=[],J,G,L=function(O){var P;for(k in O){P=O[k];if((typeof P==="function"||typeof P==="object")&&H[k]===undefined){H[k]=P}}};if(M){L(j.GetNamespace(M,null,true))}if(K){var N,M,F;for(J=0,G=K.length;J<G;J++){N=K[J],isWC=false,dotIndex=N.lastIndexOf(".");if(N.charAt(N.length-1)=="*"){isWC=true}if(isWC){M=j.GetNamespace(N.substr(0,N.length-2),null,true);if(M){L(M)}E.push(N)}else{F=dotIndex>-1?N.substr(dotIndex+1):N;var I=j.GetNamespace(N,null,true);if(I){if(H[F]===undefined){H[F]=I}}else{E.push(N)}}}}if(D){return{retObj:H,rebuildArray:E}}return H})(C,B)};j.Create=s;j.Package=t;j._a5_processImports=o;j._a5_verifyPackageQueueEmpty=function(){if(v.length){var C="",B,A;for(B=0,A=v.length;B<A;B++){C+='"'+v[B].pkg.pkg+"."+v[B].pkg.clsName+'", '+v[B].reason+' class missing: "'+v[B].reasonNM+'"'+(v.length>1&&B<v.length-1?", \n":"")}j.ThrowError(206,null,{classPlural:v.length==1?"class":"classes",clsString:C})}};j._a5_delayProtoCreation=function(A){z=A};j._a5_createQueuedPrototypes=function(){for(var B=0,A=q.length;B<A;B++){n(q[B])}q=[];for(B=0,A=u.length;B<A;B++){j.core.verifiers.validateImplementation(u[B].pkgObj,u[B].obj)}u=[]}});j.SetNamespace("a5.core.classProxyObj",{construct:{classPackage:function(k){return k?j.GetNamespace(this._a5_pkg,null,true):this._a5_pkg},className:function(){return this._a5_clsName},namespace:function(){return this._a5_namespace},imports:function(){return this._a5_imports()},doesImplement:function(k){return j.core.verifiers.checkImplements(this,k)},doesExtend:function(k){return j.core.verifiers.checkExtends(this,k)},doesMix:function(k){return j.core.verifiers.checkMixes(this,k)},getAttributes:function(){return this._a5_attributes},instance:function(n,k){if(n===true){return this._a5_instance||j.Create(this,k)}else{return this._a5_instance}},superclass:function(o,k){if(o!==undefined){if(typeof o==="object"&&o.isA5===true){if(typeof k!=="object"){k=[]}if(!this._a5_superclass.className){return j.ThrowError(210)}var n=this._a5_superclass.prototype.constructor._a5_instanceConst;if(n){n.apply(o,k)}else{j.ThrowError(211,null,{nm:this._a5_superclass.className()})}}else{j.ThrowError(212,null,{nm:this.namespace()})}}else{return this._a5_superclass.prototype}},instanceCount:function(){return this._instanceCount},isInterface:function(){return this._a5_isInterface},isFinal:function(){return this._a5_isFinal},isSingleton:function(){return this._a5_isSingleton},isAbstract:function(){return this._a5_isAbstract},isPrototype:function(){return this._a5_isPrototype},isA5ClassDef:function(){return true},isA5:true},instance:{isA5:true,isA5ClassDef:function(){return false},getStatic:function(){return this.constructor},superclass:function(n,k){return this.constructor.superclass(n,k)},mixins:function(k){if(k!==undefined){return c(k,this.imports())}else{return this.constructor._a5_mixedMethods}},mix:function(k){j.core.mixins.applyMixins(this,k,this.imports(),this)},getAttributes:function(){return this.constructor.getAttributes()},getAttributeValue:function(k){return this.constructor.getAttributeValue(k)},getMethods:function(n,o){var k=[];for(var p in this){if((n||({}).hasOwnProperty.call(this,p))&&typeof(this[p])==="function"&&j.core.classProxyObj.instance[p]===undefined&&p.substr(0,4)!=="_a5_"&&(o||p.substr(0,1)!=="_")){k.push(p)}}return k},getProperties:function(n,p){var k=[],o=function(u,v){var r=u;while(r!==null){var t=r.constructor;if(t._a5_protoProps!==undefined){var s={};t._a5_protoProps.call(s);if(s[v]!==undefined){return true}}r=t.superclass&&t.superclass().constructor.namespace?t.superclass():null}return false};for(var q in this){if((n||!o(this,q))&&typeof(this[q])!=="function"&&j.core.classProxyObj.instance[q]===undefined&&q.substr(0,4)!=="_a5_"&&(p||q.substr(0,1)!=="_")){k.push(q)}}return k},classPackage:function(k){return this.constructor.classPackage(k)},className:function(){return this.constructor.className()},getClass:function(){return this.constructor},namespace:function(){return this.constructor.namespace()},doesImplement:function(k){return this.constructor.doesImplement(k)},doesExtend:function(k){return this.constructor.doesExtend(k)},doesMix:function(k){return this.constructor.doesMix(k)},imports:function(){return this.constructor.imports()},dealloc:function(){},instanceCount:function(){return this.constructor.instanceCount()},isInterface:function(){return this.constructor.isInterface()},isFinal:function(){return this.constructor.isFinal()},isSingleton:function(){return this.constructor.isSingleton()},isAbstract:function(){return this.constructor.isAbstract()},isPrototype:function(){return this.constructor.isAbstract()},instanceUID:function(){return this._a5_instanceUID},destroy:function(){if(this._a5_initialized===true){if((this.namespace()==="a5.cl.CL"||this.classPackage().indexOf("a5.cl.core")!==-1)&&!this.classPackage()==="a5.cl.core.viewDef"){j.ThrowError(215,null,{nm:this.namespace()});return}this._a5_initialized=false;var q=this,s,o,k,t,p,n;while(q!==null){var r=q.constructor;k=r._mixinRef;if(k&&k.length){for(p=0,n=k.length;p<n;p++){if(k[p]._mixinDef.dealloc!=undefined){k[p]._mixinDef.dealloc.call(this)}}}if(r.namespace){o=r.superclass?r.superclass():null;if(o&&o.dealloc!==q.dealloc){q.dealloc.call(this)}q=o}else{q=null}}if(this.constructor._a5_instance===this){this.constructor._a5_instance=null}for(t in this){if(typeof this[t]=="function"){this[t]=j._a5_destroyedObjFunc}else{this[t]=null;delete this[t]}}if(this.__proto__){this.__proto__=j._a5_destroyedObj}}},_a5_initialize:function(s){if(!this._a5_initialized){if(this.constructor.isAbstract()&&this._a5_initialize.caller.caller!==Extend){return j.ThrowError(216,null,{nm:this.constructor.namespace()})}this._a5_initialized=true;if(this.constructor.isSingleton()&&this.constructor._a5_instance!==null){return j.ThrowError(217,null,{nm:this.constructor.namespace()})}this._a5_instanceUID=this.namespace().replace(/\./g,"_")+"__"+this.constructor.instanceCount();if(this.instanceCount()===0){this.constructor._a5_instance=this}this.constructor._instanceCount++;var u=this,k=this,o=s||[],v=[],q,p,n,r;this._a5_privatePropsRef={};if(typeof this.constructor._a5_instanceConst!=="function"){return j.ThrowError(218,null,{clsName:this.className()})}while(k!==null){var t=k.constructor;if(t._a5_attribs){j.core.attributes.applyClassAttribs(this,t._a5_attribs)}if(t._a5_protoPrivateProps!==undefined){this._a5_privatePropsRef[k.namespace()]={};t._a5_protoPrivateProps.call(this._a5_privatePropsRef[k.namespace()])}if(t._a5_protoProps!==undefined){v.unshift(t._a5_protoProps)}k=t.superclass&&t.superclass().constructor.namespace?t.superclass():null}j.core.mixins.initializeMixins(this);for(p=0,n=v.length;p<n;p++){v[p].call(this)}this.constructor._a5_instanceConst.apply(this,o);j.core.mixins.mixinsReady(this);return true}else{return null}},create:j.Create,throwError:function(){return j.ThrowError.apply(this,arguments)},assert:function(n,k){if(n!==true){throw this.create(j.AssertException,[k])}}}});j.SetNamespace("a5.core.verifiers",{namespaceArray:[],validateImplementation:function(u,p){var q,o,k,r,z,v,t,n=function(B,A){for(var C in B){if(B[C]!==A[C]){return false}}return true};for(q=0,o=u.implement.length;q<o;q++){r=u.implement[q];try{z=new p;z.Override={};z.Final={};z.Attributes=function(){var C=Array.prototype.slice.call(arguments);var E=C.pop();for(var D=0,B=C.length;D<B;D++){var A=C[D][0];if(A==="Contract"||A==="ContractAttribute"||A===j.ContractAttribute){E.attributes=C[D]}}return E};v=j.GetNamespace(r,p.imports());if(p._a5_clsDef){p._a5_clsDef.call(z,z,p.imports(),p)}}catch(s){throw s;return false}if(!v.isInterface()){return j.ThrowError(213,null,{implNM:v.namespace(),objNM:p.namespace()})}for(k in v.interfaceVals){t=z[k]!==undefined;var y=v.interfaceVals[k],w=z[k];if(t&&typeof y==="object"&&w.attributes&&(w.attributes[0]==="Contract"||w.attributes[0]==="ContractAttribute"||w.attributes[0]===j.ContractAttribute)){var x=true;for(var q=0,o=y.length;q<o;q++){x=x&&w.attributes.length>=(q+1)?n(y[q],w.attributes[q+1]):false}if(!x){return j.ThrowError(601,null,{intNM:v.namespace(),implNM:p.namespace(),method:k})}}else{if(!t||(t&&typeof v.interfaceVals[k]!==typeof z[k])){return j.ThrowError(214,null,{implNM:v.namespace(),objNM:p.namespace()})}}}p._implementsRef.push(v);z.destroy()}return true},checkNamespaceValid:function(o){for(var n=0,k=this.namespaceArray.length;n<k;n++){if(this.namespaceArray[n]==o){return false}}this.namespaceArray.push(o);return true},checkImplements:function(o,t){if(typeof t==="string"){t=j.GetNamespace(t)}var s=o._implementsRef,r,q,p,n;while(s){for(r=0,n=s.length;r<n;r++){if(s[r]===t){return true}}s=o.superclass()?o.superclass().getStatic()._implementsRef:null}return false},checkExtends:function(k,p){var o=k._a5_superclass&&k._a5_superclass.prototype.className?k._a5_superclass:null;if(!o){return false}var n=(typeof p==="string")?j.GetNamespace(p):p;if(!n){return false}while(o){if(o===n){return true}o=o._a5_superclass&&o._a5_superclass.prototype.className?o._a5_superclass:null}return false},checkMixes:function(n,p){if(typeof p==="string"){p=j.GetNamespace(p)}if(!p){return false}for(var o=0,k=n._mixinRef.length;o<k;o++){if(n._mixinRef[o]===p){return true}}return false},validateClassDependencies:function(o,x,v,n,p,y){var w,t,u,s=null,k,q,z,r;if(o!==undefined){if(typeof o==="function"){s=o}else{s=j.GetNamespace(o,x)}}w=true;if(o!==undefined&&!s){w=false;t="base";u=o}if(w&&v!==undefined){for(k in v){q=v[k];if(typeof q==="string"){z=j.GetNamespace(q,x)}if(typeof z!=="function"){w=false;t="mixin";u=q}}}if(w&&n!==undefined){for(k in n){r=n[k];if(typeof r==="string"){z=j.GetNamespace(r,x)}if(typeof z!=="function"){w=false;t="interface";u=r}}}return w?true:{reason:t,reasonNM:u}}});j.SetNamespace("a5.core.mixins",{prepareMixins:function(r){var q=r,k=r.constructor._mixinRef,p,o,s,n;if(k.length){for(p=k.length-1,o=-1;p>o;p--){if(k[p]._a5_mixinMustExtend!==undefined){for(s in k[p]._a5_mixinMustExtend){n=k[p]._a5_mixinMustExtend[s];if(!r.doesExtend(j.GetNamespace(n,r.imports()))){return j.ThrowError(400,null,{mixinNM:k[p].namespace(),instNM:r.namespace(),clsNM:n.namespace()})}}}}}},initializeMixins:function(r){var q=r,k=r.constructor._mixinRef,p,o,s,n;if(k.length){for(p=k.length-1,o=-1;p>o;p--){if(k[p]._a5_mixinProps!==undefined){k[p]._a5_mixinProps.call(q)}}for(p=0,o=k.length;p<o;p++){k[p]._a5_instanceConst.call(q)}}},mixinsReady:function(q){var k=q.constructor._mixinRef,p,o,r,n;if(k.length){for(p=k.length-1,o=-1;p>o;p--){if(k[p]._a5_mixinMustMix!==undefined){for(r in k[p]._a5_mixinMustMix){n=k[p]._a5_mixinMustMix[r];if(!inst.doesMix(j.GetNamespace(n))){return j.ThrowError(401,null,{nm:k[p].namespace(),cls:n})}}}if(typeof k[p]._mixinDef.mixinReady==="function"){k[p]._mixinDef.mixinReady.call(q)}}}},applyMixins:function(w,v,o,u){var p={},v=typeof v==="string"?[v]:v,x=[],t,s,r,q,y;for(t=0,q=v.length;t<q;t++){y=j.GetNamespace(v[t],typeof o==="function"?o():o);if(!y){return j.ThrowError(404,null,{mixin:v[t]})}x.push(y);for(s=0,r=w.constructor._mixinRef.length;s<r;s++){if(w.constructor._mixinRef[s]===y){return j.ThrowError(402,null,{nm:y.namespace()})}}for(var n in y._mixinDef){if(n!=="dealloc"&&n!=="Properties"&&n!=="mixinReady"&&n!=="MustExtend"&&n!=="Contract"){if(p[n]===undefined){if(u===undefined){w.constructor._a5_mixedMethods[n]=y._mixinDef[n]}w[n]=y._mixinDef[n];p[n]="mixed"}else{return j.ThrowError(403,null,{method:n})}}}if(u){j.core.mixins.initializeMixins(u,x,u)}else{w.constructor._mixinRef.push(y)}}}});j.SetNamespace("a5.core.errorHandling",true,function(){var n=null;this.ThrowError=function(o,r,q){var p=typeof o,s;if(p==="string"){s=o}else{if(p==="number"){if(j.GetNamespace("a5.ErrorDefinitions",null,true)){var s=j.ErrorDefinitions[o];if(!s){s="Invalid error id "+o+" thrown: error not defined."}}else{s="Error id "+o+" thrown. Include a5.ErrorDefinitions for verbose information."}o=j.Create(r||j.Error,[s,j.Error.FORCE_CAST_ERROR])}}if(s){o=j.Create(r||j.Error,[(q?k(s,q):s),j.Error.FORCE_CAST_ERROR])}n=o;throw o};this._a5_getThrownError=function(){var o=n;n=null;return o};var k=function(p,o){for(var q in o){p=p.replace(new RegExp("{"+q+"}","g"),o[q])}return p}});j.ThrowError=j.core.errorHandling.ThrowError;j._a5_getThrownError=j.core.errorHandling._a5_getThrownError;j.Package("a5").Prototype("Object",function(n,k){n.Object=function(){}});j.Package("a5").Prototype("Attribute","singleton",function(o,k,n){o.Attribute=function(){}});j.Package("a5").Extends("Attribute").Prototype("AspectAttribute",function(o,n,k){k.RETURN_NULL="_a5_aspectReturnsNull";k.SUCCESS="_a5_aspectSuccess";k.ASYNC="_a5_aspectAsync";k.FAILURE="_a5_aspectFailure";k.NOT_IMPLEMENTED="_a5_notImplemented";o.AspectAttribute=function(){o.superclass(this)};o.before=function(s,p,q,u,t,r){return k.NOT_IMPLEMENTED};o.after=function(t,q,r,v,u,s,p){return k.NOT_IMPLEMENTED};o.around=function(){return k.NOT_IMPLEMENTED}});j.Package("a5").Class("AspectCallArguments",function(u,t,r){var k,p,o,s,v,q,n;u.AspectCallArguments=function(A,x,y,C,B,z,w){k=A;p=x;o=y;s=C;v=B;q=z;n=w};u.rules=function(){return k};u.args=function(){return p};u.scope=function(){return o};u.method=function(){return s};u.callback=function(){return v};u.callOriginator=function(){return q};u.beforeArgs=function(){return n}});j.Package("a5").Extends("AspectAttribute").Class("ContractAttribute",function(n,k,q){n.ContractAttribute=function(){n.superclass(this)};n.Override.before=function(t){var u=null,v=false,s=function(w){w.message='Contract type failure on method "'+t.method().getName()+'" '+w.message;return w};if(t.rules().length>1){for(i=0,l=t.rules().length;i<l;i++){u=o(t.rules()[i],t.args());if(u instanceof j.ContractException){n.throwError(s(u));return j.AspectAttribute.FAILURE}if(u!==false){v=true;u.overloadID=i;break}}}else{v=true;u=o(t.rules()[0],t.args(),true);if(u instanceof j.ContractException){n.throwError(s(u));return j.AspectAttribute.FAILURE}}if(!v||u===false){n.throwError(s(n.create(j.ContractException,["no matching overload found"])));return j.AspectAttribute.FAILURE}else{return u}};var o=function(x,t){var w={},v=0,s,y,u;for(y in x){u=x[y];s=r((v<t.length?t[v]:undefined),u,v);if(s instanceof j.ContractException){return s}w[y]=s;v++}if(t.length>v){return false}if(t.length===0){if(v===0){return w}return false}return w},r=function(t,x,y){var w="type",u=false,z=null,v,s;if(x.indexOf("=")!=-1){v=x.split("=");x=v[0];u=true;z=v[1]}else{if(u){return n.create(j.ContractException,["for argument "+y+", required values cannot be defined after optional values"])}}if(x.indexOf(".")!==-1){w="class"}if(x==="array"){w="array"}if(x==="object"){w="object"}if(w!=="class"){x=x.toLowerCase()}if(t===undefined){if(u){t=p(x,w,z,y)}else{return n.create(j.ContractException,["for argument "+y+', missing required argument of type "'+x+'"'])}}if(t!==undefined&&t!==null){switch(w){case"class":s=j.GetNamespace(x);if(s.isInterface()){if(!(t.doesImplement(s))){return n.create(j.ContractException,["for argument "+y+", must implement interface "+x])}}else{if(!(t instanceof s)){return n.create(j.ContractException,["for argument "+y+", must be an instance of type "+x])}}break;case"type":if(t!==null&&typeof t!==x){return n.create(j.ContractException,["for argument "+y+", must be of type "+x])}break;case"array":if(Object.prototype.toString.call(t)!=="[object Array]"){return n.create(j.ContractException,["for argument "+y+", must be an array"])}break;case"object":if(t._a5_initialized!==undefined||typeof t!=="object"||t instanceof Array){return n.create(j.ContractException,["for argument "+y+", must be a generic object"])}break}}return t},p=function(t,s,y,u){var x,w=false;if(t==="string"){var v=y.charAt(0);if(v===y.charAt(y.length-1)){if(v==='"'||v==="'"){x=y.substr(1,y.length-2)}else{w=true}}else{w=true}}else{if(t==="number"){if(!isNaN(y)){x=parseInt(y)}else{w=true}}else{if(s==="class"){if(y==="null"){x=null}else{w=true}}else{if(t==="boolean"||t==="array"||t==="function"||t==="object"){switch(y){case"{}":if(t==="object"){x={}}else{w=true}break;case"[]":if(t==="array"){x=[]}else{w=true}break;case"null":x=null;break;case"true":if(t==="boolean"){x=true}else{w=true}break;case"false":if(t==="boolean"){x=false}else{w=true}break;default:w=true}}else{w=true}}}}if(w){return n.create(j.ContractException,["for argument "+u+', invalid default value for data type "'+t+'"'])}else{return x}}});j.Package("a5").Extends("AspectAttribute").Class("PropertyMutatorAttribute",function(k){k.PropertyMutatorAttribute=function(){k.superclass(this)};k.Override.before=function(p){if(p.args().length){var n=p.rules()[0].validate,o=false;if(n){if(n.indexOf(".")!==-1){o=true;var n=j.GetNamespace(n);if(!n){return j.AspectAttribute.FAILURE}}var r=o?(p.args()[0] instanceof n):(typeof p.args()[0]===n);if(!r){return j.AspectAttribute.FAILURE}}p.scope()[p.rules()[0].property]=p.args()[0];return j.AspectAttribute.SUCCESS}var q=p.scope()[p.rules()[0].property]||null;return q===null||q===undefined?j.AspectAttribute.RETURN_NULL:q};k.Override.after=function(n){if(n.beforeArgs().length){return n.scope()}else{return j.AspectAttribute.SUCCESS}}});j.Package("a5").Static(function(k){k.DESTROYED="Destroyed"}).Prototype("Event",function(k){this.Properties(function(){this._a5_type=null;this._a5_data=null;this._a5_target=null;this._a5_currentTarget=null;this._a5_phase=1;this._a5_bubbles=false;this._a5_canceled=false;this._a5_cancelPending=false;this._a5_shouldRetain=false});k.Event=function(o,n,p){this._a5_type=o;this._a5_data=p||null;this._a5_bubbles=n!==false};k.cancel=function(n){if(n===true){this._a5_cancelPending=true}else{this._a5_canceled=true}};k.target=function(){return this._a5_target};k.currentTarget=function(){return this._a5_currentTarget};k.type=function(){return this._a5_type};k.data=function(){return this._a5_data};k.phase=function(){return this._a5_phase};k.bubbles=function(){return this._a5_bubbles};k.shouldRetain=function(n){if(typeof n==="boolean"){this._a5_shouldRetain=n;return this}return this._a5_shouldRetain};k.dealloc=function(){this._a5_target=this._a5_currentTarget=null}});j.Package("a5").Static("EventPhase",function(k){k.CAPTURING=1;k.AT_TARGET=2;k.BUBBLING=3});j.Package("a5").Extends(Error).Prototype("Error",function(n,k,o){o.FORCE_CAST_ERROR="_a5_forceCastError";this.Properties(function(){this.stack=[];this.message="";this._a5_isWindowError=false;this.name=this.type=this.className()});n.Error=function(u,q){if(q===false){this._a5_isWindowError=true}if(typeof u==="string"){this.message=u}else{q=u}if(q instanceof o){if(q.stack){this.stack=q.stack.split("\n")}this.line=q.lineNumber;this.url=q.fileName;if(q.message&&this.message===""){this.message=q.message}}else{if(q!==false){try{__undefined__()}catch(v){if(v.stack){var p=v.stack.indexOf("@http")!==-1;this.stack=v.stack.split("\n");this.stack=this.stack.splice(4);if(p){for(var s=0;s<this.stack.length;s++){this.stack[s]=this.stack[s].substr(this.stack[s].indexOf("@http"))}}}else{var t=[];try{var s=0,r=this.init.caller.caller.caller;do{for(s=0,l=t.length;s<l;s++){if(t[s]===r){r=null}}if(r){if(r.toString().indexOf(o.FORCE_CAST_ERROR)===-1){this.stack.push(r.toString().replace(/;/g,";<br/>").replace(/{/g,"{<br/>").replace(/}/g,"}<br/>")+"<br/><br/>")}t.push(r);r=r.caller;s++}}while(r&&s<=50)}catch(v){}}}}}};n.isWindowError=function(){return this._a5_isWindowError};n.Override.toString=function(){return this.type+": "+this.message}});j.Package("a5").Extends("Error").Prototype("AssertException",function(k){k.AssertException=function(){k.superclass(this,arguments);this.type="AssertException"}});j.Package("a5").Extends("Error").Prototype("ContractException",function(k){k.ContractException=function(){k.superclass(this,arguments);this.type="ContractException"}});j.Package("a5").Static(function(k){k.ADD="eventDispatcherAdd";k.REMOVE="eventDispatcherRemove"}).Prototype("EventDispatcher","abstract",function(o,k,n){this.Properties(function(){this._a5_autoPurge=false;this._a5_listeners={}});o.EventDispatcher=function(){};o.autoPurge=function(p){if(typeof p==="boolean"){this._a5_autoPurge=p;return this}return this._a5_autoPurge};o.addEventListener=function(r,s,p,q){this._a5_addEventListener(r,s,p,q)};o.addOneTimeEventListener=function(r,s,p,q){this._a5_addEventListener(r,s,p,q,true)};o.hasEventListener=function(w,p){var v=w.split("|"),x=this.cl(),u,s,r,t,q;for(u=0,s=v.length;u<s;u++){r=this._a5_getListenerArray(v[u]);if(r){for(t=0,q=r.length;t<q;t++){if(r[t].type==v[u]&&(typeof p==="function"?(r[t].method==p):true)){return true}}}}return false};o.removeEventListener=function(z,p,r,A,v){var y=z.split("|"),q=true,x,u,t,w,s;A=A||null;v=v||false;r=r===true;for(x=0,u=y.length;x<u;x++){t=this._a5_getListenerArray(y[x]);if(t){for(w=0,s=t.length;w<s;w++){if(t[w].method===p&&t[w].type===y[x]&&t[w].useCapture===r&&t[w].isOneTime===v){t.splice(w,1);s=t.length}}this.eListenersChange({type:y.length>1?y:y[0],method:p,useCapture:r,changeType:n.REMOVE})}}};o.removeAllListeners=function(){if(this._a5_listeners){this._a5_listeners={}}};o.getTotalListeners=function(q){if(typeof q==="string"){var p=this._a5_getListenerArray(q);if(p){return p.length}else{return 0}}else{var r=0;for(var s in this._a5_listeners){r+=this._a5_listeners[s].length}return r}};o.dispatchEvent=function(q,r,p){var s=this._a5_createEvent(q,r,p);s._a5_phase=j.EventPhase.AT_TARGET;this._a5_dispatchEvent(s);if(!s.shouldRetain()){s.destroy()}s=null};o.eListenersChange=function(p){};o._a5_addEventListener=function(z,p,A,B,C){var D=B||null,y=z.split("|"),v=C||false,r=A===true,q=true,x,u,t,w,s;if(y.length!=0&&p!=undefined){for(x=0,u=y.length;x<u;x++){t=this._a5_getListenerArray(y[x],true);for(w=0,s=t.length;w<s;w++){if(t[w].method===p&&t[w].type===y[x]&&t[w].useCapture===r&&t[w].scope===D&&t[w].isOneTime===v){q=false;break}}if(q){t.push({type:y[x],method:p,scope:D,useCapture:r===true,isOneTime:v})}}this.eListenersChange({type:y.length>1?y:y[0],method:p,changeType:n.ADD})}else{throw"invalid listener: type- "+z+", method- "+p}};o._a5_createEvent=function(q,r,p){var s=(typeof q==="string")?j.Create(j.Event,[q,p]):q;if(s instanceof j.Event||s.doesExtend&&s.doesExtend(j.Error)){s._a5_target=this;if(r){s._a5_data=r}return s}throw"Invalid event type."};o._a5_dispatchEvent=function(t){t._a5_currentTarget=this;if(this._a5_listeners){var u=this._a5_getListenerArray(t.type()),r,p,q,s;if(u){for(r=0,p=u.length;r<p;r++){q=u?u[r]:null;if(t._a5_canceled||!q){return}s=(t.phase()===j.EventPhase.CAPTURING&&q.useCapture)||(t.phase()!==j.EventPhase.CAPTURING&&!q.useCapture),validListener=typeof q.method==="function"&&(q.scope&&q.scope.namespace?q.scope._a5_initialized:true);if(s&&validListener){q.method.call(q.scope,t)}if(q.isOneTime===true||(!validListener&&this._a5_autoPurge)){u.splice(r,1);r--;p--}}}}};o._a5_getListenerArray=function(q,p){if(this._a5_listeners[q]===undefined){if(p===true){this._a5_listeners[q]=[];return this._a5_listeners[q]}return null}return this._a5_listeners[q]};o.dealloc=function(){this.dispatchEvent(j.Create(j.Event,[j.Event.DESTROYED]));this.removeAllListeners();this._a5_listeners=null}});j.SetNamespace("a5.ErrorDefinitions",{100:'invalid namespace "{namespace}", namespaces must contain only letters, numbers, or periods.',101:"TrackWindowStrays must be called prior to GetWindowStrays.",200:'Invalid attempt to define new method "{prop}" in class "{namespace}", without calling override, method exists in superclass.',201:'Invalid attempt to override method "{prop}" in class "{namespace}", method marked as Final in superclass.',202:'Invalid attempt to override method "{prop}" in class "{namespace}", method not defined in superclass.',203:'Invalid attempt to override method "{prop}" in class "{namespace}", method marked as Final in superclass.',204:'Interface "{objNM}" cannot extend the non interface class "{clsNM}"',205:'Mixin "{nm}" doesn not specify a constructor.',206:"Class definitions not found for the following expected {classPlural}: \n {clsString}",207:"Error creating new class instance: cannot find object {className}.",208:"Cannot instantiate class {nm} , interfaces must be associated by the Implements directive.",209:"Error creating class instance {nm} ({errorStr})",210:"Superclass called on an object without a superclass.",211:'Constructor not defined on class "{nm}"',212:'invalid scope argument passed to superclass constructor on class "{nm}".',213:'Cannot implement "{implNM}" on class "{objNM}", class is not an interface.',214:'Invalid implementation of interface "{implNM}" , on class "{objNM}".',215:'Destroy called on core object "{nm}"',216:'Cannot directly instantiate class "{nm}", class marked as abstract.',217:'Cannot create new instance of class "{nm}", class marked as singleton already exists.',218:'Constructor not defined on class "{clsName}"',219:'Class "{currClass}" requires "{checkedClass}"',220:'Invalid attempt to define new method "{prop}" in class "{namespace}", without calling override, method exists in mixin.',300:'Invalid attribute definition: "Attributes" call must take a function as its last parameter.',301:"Invalid attribute definition: No attributes were defined.",302:"Attribute error: Attributes call accepts only arrays as attribute annotations.",303:"Attribute error: First parameter must be a reference to a class that extends a5.Attribute.",304:"Attribute error: invalid parameter specified for Attribute, params must be key/value pair objects.",305:"Attribute error: no parameters passed to Attribute call.",308:'Error processing attribute "{prop}", "{method}" must return a value.',400:'Mixin "{mixinNM}" requires mixing object "{instNM}" to extend class "{clsNM}" .',401:'Mixin "{nm}" requires owner class to mix "{cls}".',402:'Mixin "{nm}" already mixed into ancestor chain.',403:'Invalid mixin: Method "{method}" defined by more than one specified mixin.',404:'Invalid mixin: Mixin "{mixin}" does not exist.',601:"Invalid implementation of Contract on interace {intNM} in class {implNM} for method {method}."})})(this);(function(global){var a5=global.a5;a5.SetNamespace("a5.cl",true,function(){var initializer=null,createCalled=false,createCallbacks=[];var instance=function(){return a5.cl.CL.instance()},CreateApplication=function(props,callback){if(!createCalled){createCalled=true;if(a5.cl.CLMain._extenderRef.length===0){var str="A5 CL requires a class that extends a5.cl.CLMain.";throw str}else{if(typeof props==="function"){callback=props;props=undefined}if(props===undefined){props={}}if(callback&&typeof callback==="function"){CreateCallback(callback)}var initializeComplete=function(){a5.Create(a5.cl.CL,[props||{},initializer]);var inst=a5.cl.instance();for(var i=0,l=createCallbacks.length;i<l;i++){createCallbacks[i](inst)}createCallbacks=null;if(initializer!==null){initializer.applicationInitialized(inst)}inst._cl_launch()};if(initializer!==null){initializer.initialize(props,initializeComplete)}else{initializeComplete()}return function(){return a5.cl.CL.instance()}}}else{throw"Error: a5.cl.CreateApplication can only be called once."}},RegisterInitializer=function(_initializer){if(initializer==null){initializer=_initializer}else{throw"initializer error"}},CreateCallback=function(callback){createCallbacks.push(callback)};return{instance:instance,CreateApplication:CreateApplication,RegisterInitializer:RegisterInitializer,CreateCallback:CreateCallback}});a5.Package("a5.cl").Extends("a5.EventDispatcher").Prototype("CLBase",function(proto){this.Properties(function(){this._cl_mvcName=null});proto.CLBase=function(){proto.superclass(this)};proto.cl=function(){return a5.cl.instance()};proto.getClassInstance=function(type,className){return this.cl()._core().instantiator().getClassInstance(type,className)};proto.log=function(value){var plgn=this.plugins().getRegisteredProcess("logger");if(plgn){return plgn.log.apply(this,arguments)}else{if("console" in window){console.log.apply(console,arguments)}}};proto.warn=function(value){var plgn=this.plugins().getRegisteredProcess("logger");if(plgn){return plgn.warn.apply(this,arguments)}else{if("console" in window){console.warn.apply(console,arguments)}}};proto.Override.throwError=function(error){proto.superclass().throwError(error,a5.cl.CLError)};proto.config=function(){return this.cl().config()};proto.plugins=function(){return this.cl().plugins()};proto.appParams=function(){return this.cl().appParams()}});a5.Package("a5.cl").Extends("a5.cl.CLBase").Prototype("CLInitializer",function(cls,im){cls.CLInitializer=function(){cls.superclass(this);a5.cl.RegisterInitializer(this)};cls.initialize=function(props,callback){throw"Classes extending CLInitializer must override initialize method without calling super."};cls.load=function(arr,complete,progress){return false};cls.applicationInitialized=function(inst){}});a5.Package("a5.cl").Extends("a5.Error").Prototype("CLError",function(proto,im){proto.CLError=function(){proto.superclass(this,arguments);this.type="CLError"}});a5.Package("a5.cl").Enum("CLLaunchState",function(cls){cls.addValue("APPLICATION_INITIALIZING");cls.addValue("DEPENDENCIES_LOADING");cls.addValue("DEPENDENCIES_LOADED");cls.addValue("AUTO_INSTANTIATION_COMPLETE");cls.addValue("PLUGINS_LOADED");cls.addValue("LAUNCH_INTERCEPTED");cls.addValue("APPLICATION_WILL_LAUNCH");cls.addValue("APPLICATION_LAUNCHED")});a5.Package("a5.cl").Extends("a5.Event").Static(function(CLEvent){CLEvent.ONLINE_STATUS_CHANGE="onlineStatusChange";CLEvent.ERROR_THROWN="errorThrown";CLEvent.APPLICATION_INITIALIZING="applicationInitializing";CLEvent.CORE_LOADED="coreLoaded";CLEvent.DEPENDENCIES_LOADING="dependenciesLoading";CLEvent.DEPENDENCIES_LOADED="dependenciesLoaded";CLEvent.AUTO_INSTANTIATION_COMPLETE="autoInstantiationComplete";CLEvent.PLUGINS_LOADED="pluginsLoaded";CLEvent.APPLICATION_PREPARED="applicationPrepared";CLEvent.LAUNCH_INTERCEPTED="launchIntercepted";CLEvent.APPLICATION_WILL_LAUNCH="applicationWillLaunch";CLEvent.APPLICATION_LAUNCHED="applicationLaunched";CLEvent.APPLICATION_WILL_CLOSE="applicationWillClose";CLEvent.APPLICATION_CLOSED="applicationClosed";CLEvent.WINDOW_RESIZED="windowResized";CLEvent.APPLICATION_WILL_RELAUNCH="applicationWillRelaunch";CLEvent.GLOBAL_UPDATE_TIMER_TICK="globalUpdateTimerTick";CLEvent.ASYNC_START="asyncStart";CLEvent.ASYNC_COMPLETE="asyncComplete";CLEvent.ORIENTATION_CHANGED="orientationChanged";CLEvent.CLIENT_ENVIRONMENT_UPDATED="clientEnvironmentUpdated";CLEvent.APPLICATION_ERROR="applicationError"}).Prototype("CLEvent",function(proto,im){proto.CLEvent=function(){proto.superclass(this,arguments)}});a5.Package("a5.cl.interfaces").Interface("IHTMLTemplate",function(cls){cls.populateTemplate=function(){}});a5.Package("a5.cl.interfaces").Interface("ILogger",function(cls){cls.log=function(){}});a5.Package("a5.cl.interfaces").Interface("IServiceURLRewriter",function(cls){cls.rewrite=function(){}});a5.Package("a5.cl.interfaces").Interface("ILaunchInterceptor",function(cls){cls.interceptLaunch=function(){}});a5.Package("a5.cl.interfaces").Interface("IDataCacheProvider",function(IDataCacheProvider){IDataCacheProvider.isAvailable=function(){};IDataCacheProvider.cacheExists=function(){};IDataCacheProvider.storeValue=function(){};IDataCacheProvider.getValue=function(){};IDataCacheProvider.clearValue=function(){};IDataCacheProvider.clearScopeValues=function(){}});a5.Package("a5.cl.interfaces").Interface("IBindableReceiver",function(cls){cls.receiveBindData=function(){}});a5.Package("a5.cl.core").Extends("a5.cl.CLBase").Class("PluginManager","singleton final",function(self){var plugins=[],addOns=[],processes={animation:null,htmlTemplate:null,serviceURLRewriter:null,logger:null,dataCacheProvider:null,launchInterceptor:null,presentationLayer:null};this.PluginManager=function(){self.superclass(this);self.plugins()["getRegisteredProcess"]=this.getRegisteredProcess};this.instantiatePlugins=function(){var classes=[],i,l,plugin,pi,cfg,obj;for(i=0,l=a5.cl.CLPlugin._extenderRef.length;i<l;i++){if(a5.cl.CLPlugin._extenderRef[i]!==a5.cl.CLAddon){classes.push(a5.cl.CLPlugin._extenderRef[i])}}for(i=0,l=a5.cl.CLAddon._extenderRef.length;i<l;i++){addOns.push(a5.cl.CLAddon._extenderRef[i]);classes.push(a5.cl.CLAddon._extenderRef[i])}for(i=0,l=classes.length;i<l;i++){plugin=classes[i];if(!plugin.isAbstract()){pi=plugin.instance(true);cfg=pi._cl_sourceConfig();obj=a5.cl.core.Utils.mergeObject(cfg||{},pi.configDefaults());pi._cl_isFinal=pi._cl_isSingleton=true;if(!a5.cl.core.Utils.testVersion(pi.requiredVersion())){throw'Error - plugin "'+plugin.className()+'" requires at least CL version '+pi.requiredVersion();return}if(pi.maxVerifiedVersion()&&!self.config().allowUntestedPlugins&&!a5.cl.core.Utils.testVersion(pi.maxVerifiedVersion(),true)){throw"Error - untested version";return}pi._cl_pluginConfig=obj;if(pi instanceof a5.cl.CLAddon){if(a5.cl.CLBase.prototype[plugin.className()]===undefined){a5.cl.CLBase.prototype[plugin.className()]=function(){var p=pi;return function(){return p}}()}}else{if(self.plugins()[plugin.className()]==undefined){self.plugins()[plugin.className()]=function(){var p=pi;return function(){return p}}()}}plugins.push(pi)}}for(var i=0,l=plugins.length;i<l;i++){var checkResult=checkRequires(plugins[i]);if(checkResult){throw'Error: plugin "'+plugins[i].className()+'" requires plugin "'+checkResult;return}plugins[i].initializePlugin()}a5.cl.PluginConfig=function(){self.throwError(self.create(a5.cl.CLError,["Invalid call to MVC pluginConfig method: method must be called prior to plugin load."]))}};this.defineRegisterableProcess=function(process){processes[process]=null};this.registerForProcess=function(type,instance){var val=processes[type];if(val===null){processes[type]=instance}else{if(val===undefined){self.redirect(500,"Error registering process for type '"+type+"', type does not exist.")}else{self.warn("Multiple plugins trying to register for process '"+type+"'.")}}};this.getRegisteredProcess=function(type){return processes[type]};this.processAddons=function(callback){var count=0,processAddon=function(){if(count>=addOns.length){callback();return}else{var addOn=addOns[count].instance(),isAsync=addOn.initializeAddOn()===true;count++;if(isAsync){addOn.addOneTimeEventListener(a5.cl.CLAddon.INITIALIZE_COMPLETE,processAddon)}else{processAddon()}}};processAddon()};var checkRequires=function(plugin){var r=plugin._cl_requires;for(var i=0,l=r.length;i<l;i++){if(!a5.GetNamespace(r[i],null,true)){return r[i]}}return false}});a5.Package("a5.cl.core").Import("a5.cl.CLEvent").Extends("a5.cl.CLBase").Class("Instantiator","singleton final",function(self,im){var applicationPackage,_applicationPackageInstance,namespaceArray=[["services",[a5.cl.CLService,a5.cl.CLSocket,a5.cl.CLAjax]]];this.Instantiator=function($applicationPackage){self.superclass(this);applicationPackage=$applicationPackage;_applicationPackageInstance=a5.SetNamespace(applicationPackage)};this.applicationPackage=function(returnString){if(returnString){return applicationPackage}else{return _applicationPackageInstance}};this.registerAutoInstantiate=function(name,clsArray){namespaceArray.push([name,clsArray])};this.Override.getClassInstance=function(type,className,instantiate){var instance=null,namespace=null;if(className.indexOf(".")!==-1){namespace=a5.GetNamespace(className)}else{namespace=getClassNamespace(type,className)}if(namespace){instance=namespace.instance(!!instantiate)}return instance};this.createClassInstance=function(clsName,type){var cls=getClassNamespace(type,clsName),instance,clsPath=null;if(cls){var clsInstance;clsInstance=(cls._a5_instance===null)?this.create(cls):cls.instance();clsInstance._cl_setMVCName(clsName);return clsInstance}else{return null}};this.instantiateConfiguration=function(){var retObj=a5.cl.CLMain._cl_storedCfgs.config;var plgnArray=a5.cl.CLMain._cl_storedCfgs.pluginConfigs;for(var i=0;i<plgnArray.length;i++){var obj={};var split=plgnArray[i].nm.split("."),lastObj=obj;for(var j=0;j<split.length;j++){lastObj=lastObj[split[j]]=j==split.length-1?plgnArray[i].obj:{}}retObj.plugins=a5.cl.core.Utils.mergeObject(retObj.plugins,obj)}return retObj};this.beginInstantiation=function(){for(var i=0,l=namespaceArray.length;i<l;i++){var liveNamespace=a5.GetNamespace(applicationPackage+"."+namespaceArray[i][0],null,true);if(liveNamespace&&typeof liveNamespace=="object"){for(var prop in liveNamespace){if(typeof liveNamespace[prop]==="function"){var instance=self.create(liveNamespace[prop]);liveNamespace[prop]._cl_isFinal=true;if(namespaceArray[i][0]==="domains"){instance._name=prop;liveNamespace[prop]._a5_isSingleton=true}else{instance._name=prop.substr(0,prop.toLowerCase().indexOf(namespaceArray[i][0].substr(0,namespaceArray[i][0].length-1)))}var isValid=false;for(var j=0,m=namespaceArray[i][1].length;j<m;j++){if(instance instanceof namespaceArray[i][1][j]){isValid=true}}if(!isValid){self.redirect(500,"Error instantiating "+namespaceArray[i][0]+" class "+instance.namespace()+", must extend "+namespaceArray[i][1].namespace())}}}}}self.cl().dispatchEvent(im.CLEvent.AUTO_INSTANTIATION_COMPLETE)};var getClassNamespace=function(type,clsName){return a5.GetNamespace(applicationPackage+"."+type.toLowerCase()+"s."+clsName+(type=="domain"?"":(type.substr(0,1).toUpperCase()+type.substr(1))))}});a5.Package("a5.cl.core").Static("Utils",function(Utils){Utils.isAbsolutePath=function(url){return(url.indexOf("://")!==-1||url.substr(0,1)=="/")};Utils.makeAbsolutePath=function(url){return Utils.isAbsolutePath(url)?(url.substr(0,1)=="/"?a5.cl.instance().initializer().environmentManager().appPath(true)+url:url):(a5.cl.instance().initializer().environmentManager().appPath()+url)};Utils.trim=function(str){if(!str){return str}return str.replace(/(^\s+)|(\s+$)/g,"").replace(/\s{2,}/," ")};Utils.mergeObject=function(mergeObj,sourceObj,$setSourceObj){var setSourceObj=$setSourceObj||false,retObj,prop;if(mergeObj==null){return sourceObj}if(sourceObj==null){return mergeObj}function recursiveMerge(sourceObj,mergeObj){for(prop in mergeObj){if(prop!=="prototype"&&prop!=="constructor"){if(sourceObj[prop]!==undefined&&sourceObj[prop]!==null&&sourceObj[prop]!==sourceObj){if(typeof sourceObj[prop]==="object"){if(Object.prototype.toString.call(sourceObj[prop])==="[object Array]"){if(Object.prototype.toString.call(mergeObj[prop])==="[object Array]"){sourceObj[prop]=sourceObj[prop].concat(mergeObj[prop])}}else{sourceObj[prop]=recursiveMerge(sourceObj[prop],mergeObj[prop])}}else{sourceObj[prop]=mergeObj[prop]}}else{sourceObj[prop]=mergeObj[prop]}}}return sourceObj}retObj=recursiveMerge(sourceObj,mergeObj);if(setSourceObj){sourceObj=retObj}return retObj};Utils.deepClone=function(obj){if(typeof obj!=="object"||obj==null){return obj}var c=Utils.isArray(obj)?[]:{};for(var i in obj){var value=obj[i];if(typeof value=="object"){if(Utils.isArray(value)){c[i]=[];for(var j=0,l=value.length;j<l;j++){if(typeof value[j]!="object"){c[i].push(value[j])}else{c[i].push(Utils.deepClone(value[j]))}}}else{c[i]=Utils.deepClone(value)}}else{c[i]=value}}return c};Utils.initialCap=function(str){return str.substr(0,1).toUpperCase()+str.substr(1)};Utils.validateHexColor=function(color){return/^#(([a-fA-F0-9]){3}){1,2}$/.test(color)};Utils.expandHexColor=function(color){if(a5.cl.core.Utils.validateHexColor(color)){if(color.length===4){return"#"+color.substr(1,1)+color.substr(1,1)+color.substr(2,1)+color.substr(2,1)+color.substr(3,1)+color.substr(3,1)}else{return color}}else{return"#000000"}};Utils.arrayIndexOf=function(array,value){for(var x=0,y=array.length;x<y;x++){if(array[x]===value){return x}}return -1};Utils.arrayContains=function(array,value){return Utils.arrayIndexOf(array,value)!==-1};Utils.isArray=function(array){return Object.prototype.toString.call(array)==="[object Array]"};Utils.testVersion=function(val,isMax){var parseVersionString=function(val){val=val.split(".");return{major:parseInt(val[0])||0,minor:parseInt(val[1])||0,build:parseInt(val[2])||0}};isMax=isMax||false;var versionVal=parseVersionString(a5.version()),testVal=parseVersionString(String(val));if(versionVal.major!==testVal.major){return isMax?(versionVal.major<testVal.major):(versionVal.major>testVal.major)}else{if(versionVal.minor!==testVal.minor){return isMax?(versionVal.minor<testVal.minor):(versionVal.minor>testVal.minor)}else{if(versionVal.build!==testVal.build){return isMax?(versionVal.build<testVal.build):(versionVal.build>testVal.build)}else{return true}}}};Utils.viewInStack=function(view){var appView=a5.cl.mvc.core.AppViewContainer.instance();while(view){if(view===appView){return true}view=view.parentView()}return false}});a5.Package("a5.cl.core").Import("a5.cl.CLEvent").Extends("a5.cl.CLBase").Class("RequestManager","final",function(self,im){var defaultContentType,defaultMethod,reqArray,asyncRunning=false,reqCount;this.RequestManager=function(){self.superclass(this,arguments);reqArray=[];reqCount=0;defaultContentType=self.config().requestDefaultContentType;defaultMethod=self.config().requestDefaultMethod};this.asyncRunning=function(){return asyncRunning};this.processItem=function(props,reqID){var req;try{var reqComplete=function($req){if(getPropsForID(reqID)){var req=this;if(req.readyState==4){var response,retData,status=req.status;if(status!==500){if(props.isJson){response=req.responseText;if(a5.cl.core.Utils.trim(response)!==""){try{response=a5.cl.core.JSON.parse(response);retData=(props.dataProp&&props.dataProp!==undefined)?response[props.dataProp]:response}catch(e){status=500;retData="Error parsing JSON response from url: "+props.url+"\nresponse: "+response}}}else{if(props.isXML&&req.responseXML){response=req.responseXML}else{response=req.responseText}}if(retData===undefined){retData=response}}if(status==200||(status==0)){self.success(reqID,retData)}else{self.onError(reqID,status,retData||req.responseText)}self.reqComplete(reqID)}}},updateProgress=function(e){self.updateProgress(reqID,e)},onError=function(e){self.onError(reqID,req.status,e)},createAppend=function(data,isGet){var retString=isGet?"?":"";for(var prop in data){retString+=prop+"="+data[prop]+"&"}return retString.substr(0,retString.length-1)},contentType=null;req=XMLHttpRequest?new XMLHttpRequest():new ActiveXObject("MSXML2.XMLHTTP.3.0");if(req!==undefined){var method=props.method||defaultMethod,data=props.data||null,urlAppend=method=="GET"?createAppend(props.data,true):"";if(data){if(props.formData===true){contentType="multipart/form-data";var fd=new FormData();for(var prop in data){fd.append(prop,data[prop])}data=fd}else{if(props.isJson){data=a5.cl.core.JSON.stringify(data)}else{contentType="application/x-www-form-urlencoded";data=createAppend(data,false)}}}if(contentType===null){contentType=defaultContentType}if(props.contentType){contentType=props.contentType}props.isJson=props.isJson!==undefined?props.isJson:(contentType&&contentType.toLowerCase().indexOf("json")!=-1?true:false);props.isXML=(!props.isJson&&contentType.toLowerCase().indexOf("xml"))!=-1?true:false;props.charSet=props.charSet||null;if(req.addEventListener!=undefined){req.addEventListener("progress",updateProgress,false)}if(XMLHttpRequest){req.onerror=onError}req.onreadystatechange=reqComplete;req.open(method,props.url+urlAppend,true);if(props.formData!==true){req.setRequestHeader("Content-type",contentType)}if(props.charSet){req.setRequestHeader("charset",props.charSet)}req.send(data)}else{if(props.error){props.error("client does not support XMLHTTPRequests")}}}catch(e){req=null;self.throwError(e)}};this.abortRequest=function(id){for(var i=0;i<reqArray.length;i++){if(reqArray[i].id===id){reqArray[i].abort();reqArray.splice(i,1);return}}self.redirect(500,"Cannot abort request; invalid identifier sent to abortRequest method.")};this.makeRequest=function(props){if((reqArray.length===0||isSilent())&&props.silent!==true){asyncRunning=true;self.cl().dispatchEvent(im.CLEvent.ASYNC_START)}var reqID=reqCount++;props.url=a5.cl.core.Utils.makeAbsolutePath(props.url);var obj={props:props,id:reqID,abort:function(){self.abortRequest(this.id)}};reqArray.push(obj);self.processItem(props,reqID);return obj};this.success=function(id,data){var props=getPropsForID(id);if(props.success){props.success.call(self,data)}};this.reqComplete=function(id){unqueueItem(id);if(reqArray.length===0||checkSilentReq()){asyncRunning=false;self.cl().dispatchEvent(im.CLEvent.ASYNC_COMPLETE)}};this.updateProgress=function(id,e){var props=getPropsForID(id);if(props.progress){props.progress.call(self,e)}};this.onError=function(id,status,errorObj){if(status!=200&&status!=0){var props=getPropsForID(id);if(props&&props.error){props.error.call(self,status,errorObj)}else{this.throwError(errorObj)}}};var checkSilentReq=function(){for(var i=0,l=reqArray.length;i<l;i++){if(reqArray[i].props.silent!==true){return false}}return true};var getPropsForID=function(id){for(var i=0,l=reqArray.length;i<l;i++){if(reqArray[i].id==id){return reqArray[i].props}}};var unqueueItem=function(value){var isNumber=typeof value=="number";for(var i=0,l=reqArray.length;i<l;i++){if((isNumber&&reqArray[i].id==value)||reqArray[i]==value){reqArray.splice(i,1);return}}};var isSilent=function(){for(var i=0,l=reqArray.length;i<l;i++){if(reqArray[i].props.silent===true){return true}}return false}});a5.cl.core.JSON=function(){var self=this;var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;var init=function(){if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}};var stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){a5.cl.instance().redirect(500,"JSON stringify error.")}return str("",{"":value})};var parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}a5.cl.instance().redirect(500,new SyntaxError("JSON.parse"))};var f=function(n){return n<10?"0"+n:n};function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}init();return{stringify:stringify,parse:parse}}();a5.Package("a5.cl.core").Static(function(DataCache){DataCache.enabled=function(){return DataCache.instance().enabled()};DataCache.cacheExists=function(){return DataCache.instance().cacheExists()};DataCache.isAvailable=function(){return DataCache.instance().isAvailable()};DataCache.storeValue=function(key,value){return DataCache.instance().storeValue(key,value)};DataCache.getValue=function(key){return DataCache.instance().getValue(key)};DataCache.clearValue=function(key){return DataCache.instance().clearValue(key)};DataCache.clearScopeValues=function(scope,exceptions){return DataCache.instance().clearScopeValues(scope,exceptions)};DataCache.validateCacheKeyPrefix=function(key){return DataCache.instance().validateCacheKeyPrefix(key)};DataCache.removeCacheKeyPrefix=function(key){return DataCache.instance().removeCacheKeyPrefix(key)}}).Extends("a5.cl.CLBase").Class("DataCache","singleton final",function(self,im){var _enabled,cacheKeys,provider;this.DataCache=function(cacheEnabled){self.superclass(this);_enabled=cacheEnabled;cacheKeys=[]};this.enabled=function(){return _enabled};this.isAvailable=function(){getCacheProvider().isAvailable()};this.cacheExists=function(){return getCacheProvider().cacheExists()};this.storeValue=function(key,value){if(self.isAvailable()&&checkCacheKey(key)){return getCacheProvider().storeValue(key)}else{return false}};this.getValue=function(key){if(self.isAvailable()&&checkCacheKey(key)){return getCacheProvider().getValue(key)}};this.clearValue=function(key){if(self.isAvailable()&&checkCacheKey(key)){return getCacheProvider().clearValue(key)}};this.clearScopeValues=function(scope,$exceptions){return getCacheProvider().clearScopeValues(scope,$exceptions)};this.validateCacheKeyPrefix=function(key){for(var i=0,l=cacheKeys.length;i<l;i++){if(cacheKeys[i]==key){return false}}cacheKeys.push(key);return true};this.removeCacheKeyPrefix=function(key){for(var i=0,l=cacheKeys.length;i<l;i++){if(cacheKeys[i]==key){cacheKeys.splice(i,1);return}}};var checkCacheKey=function(key){var isInCache=false;for(var i=0,l=cacheKeys.length;i<l;i++){if(key.substr(cacheKeys[i])!=-1){isInCache=true;break}}return isInCache};var getCacheProvider=function(){if(!provider){provider=self.plugins().getRegisteredProcess("dataCacheProvider")}return provider}});a5.Package("a5.cl.core").Import("a5.cl.CLEvent").Extends("a5.cl.CLBase").Class("GlobalUpdateTimer","singleton final",function(self,im){var timer,clInstance,interval,evtInstance=a5.Create(im.CLEvent,[im.CLEvent.GLOBAL_UPDATE_TIMER_TICK]);this.GlobalUpdateTimer=function(_interval){self.superclass(this);interval=_interval;clInstance=self.cl();evtInstance.shouldRetain(true)};this.startTimer=function(){if(!timer){timer=setInterval(update,interval)}};this.stopTimer=function(){this._cl_killTimer()};var update=function(){clInstance.dispatchEvent(evtInstance)};this._cl_killTimer=function(){if(timer){clearInterval(timer);timer=null}}});a5.Package("a5.cl.core").Import("a5.cl.CLEvent","a5.cl.CLLaunchState").Extends("a5.cl.CLBase").Class("Core","singleton final",function(self,im){var _cache,_params,_requestManager,_globalUpdateTimer,_instantiator,_pluginManager,_launchState;this.Core=function(params){self.superclass(this);_params=params;_instantiator=self.create(a5.cl.core.Instantiator,[params.applicationPackage])};this.instantiator=function(){return _instantiator};this.cache=function(){return _cache};this.requestManager=function(){return _requestManager};this.pluginManager=function(){return _pluginManager};this.globalUpdateTimer=function(){return _globalUpdateTimer};this.launchState=function(){return _launchState};this.relaunch=function(){self.cl().dispatchEvent(im.CLEvent.APPLICATION_WILL_RELAUNCH);window.location.reload()};this.initializeCore=function($environment,$clientEnvironment){updateLaunchStatus("APPLICATION_INITIALIZING");_globalUpdateTimer=self.create(a5.cl.core.GlobalUpdateTimer,[_params.globalUpdateTimerInterval]);_requestManager=self.create(a5.cl.core.RequestManager,[_params.requestDefaultMethod,_params.requestDefaultContentType]);_pluginManager=self.create(a5.cl.core.PluginManager);_cache=self.create(a5.cl.core.DataCache,[_params.cacheEnabled]);updateLaunchStatus("CORE_LOADED");var loadPaths=self.config().dependencies;if(loadPaths.length){if(self.cl().initializer()){var implemented=self.cl().initializer().load(loadPaths,dependenciesLoaded,function(e){updateLaunchStatus("DEPENDENCIES_LOADING",e)});if(implemented==false){dependenciesLoaded()}}else{dependenciesLoaded()}}else{dependenciesLoaded()}};var dependenciesLoaded=function(){updateLaunchStatus("DEPENDENCIES_LOADED");_pluginManager.instantiatePlugins();updateLaunchStatus("PLUGINS_LOADED");updateLaunchStatus("APPLICATION_PREPARED");_instantiator.beginInstantiation();var plgn=_pluginManager.getRegisteredProcess("launchInterceptor");if(plgn){var intercept=plgn.interceptLaunch(launchApplication);if(intercept){updateLaunchStatus("LAUNCH_INTERCEPTED",{interceptor:plgn})}else{launchApplication()}}else{launchApplication()}};var launchApplication=function(){_pluginManager.processAddons(addOnsLoaded)};var addOnsLoaded=function(){updateLaunchStatus("APPLICATION_WILL_LAUNCH");updateLaunchStatus("APPLICATION_LAUNCHED")};var updateLaunchStatus=function(type,e){_launchState=im.CLLaunchState[type];self.cl().dispatchEvent(im.CLEvent[type],e)}});a5.Package("a5.cl.mixins").Import("a5.cl.core.DataCache").Mixin("DataStore",function(proto,im,DataStore){this.Properties(function(){this._cl_cacheKeyValidated=false;this._cl_prefix=null;this._cl_validatedPrefix=null});proto.DataStore=function(){};proto.cacheExists=function(){return im.DataCache.cacheExists()};proto.storeValue=function(key,value){if(im.DataCache.isAvailable()&&value!==undefined){return im.DataCache.storeValue(this._cl_createCacheKey(key),value)}else{return false}};proto.keyPrefix=function(value){if(typeof value==="string"){this._cl_prefix=value;return this}return this._cl_prefix};proto.getValue=function(key){if(im.DataCache.isAvailable()){return im.DataCache.getValue(this._cl_createCacheKey(key))}else{return false}};proto.clearValue=function(key){if(im.DataCache.isAvailable()){return im.DataCache.clearValue(this._cl_createCacheKey(key))}else{return false}};proto.clearScopeValues=function(exceptions){if(im.DataCache.isAvailable()){im.DataCache.clearScopeValues(this.instanceUID(),exceptions)}else{return false}};proto._cl_createCacheKey=function(key){if(!this._cl_cacheKeyValidated||!this._cl_validatedPrefix){var prefix=(this._cl_prefix||(this.id?this.id():false)||this.instanceUID());this._cl_cacheKeyValidated=im.DataCache.validateCacheKeyPrefix(prefix);if(!this._cl_cacheKeyValidated){a5.ThrowError("Error: Duplicate cache key prefix: "+prefix);return}this._cl_validatedPrefix=prefix}return this._cl_validatedPrefix+"_"+key};proto.dealloc=function(){im.DataCache.removeCacheKeyPrefix(this._cl_validatedPrefix)}});a5.Package("a5.cl.mixins").Mixin("BindableSource",function(mixin,im){this.Properties(function(){this._cl_receivers=null;this._cl_bindParamType=null;this._cl_bindParamRequired=false;this._cl_bindParamCallback=null});mixin.BindableSource=function(){this._cl_receivers=[]};mixin.bindParamProps=function(type,required,callback){this._cl_bindParamType=type;if(required!==undefined){this._cl_bindParamRequired=required}if(callback!==undefined){this._cl_bindParamCallback=callback}return this};mixin.bindParamType=function(){return this._cl_bindParamType};mixin.bindParamRequired=function(){return this._cl_bindParamRequired};mixin.notifyReceivers=function(data,params){for(var i=0,l=this._cl_receivers.length;i<l;i++){var r=this._cl_receivers[i];if(params===undefined||params===r.params){if(this._cl_bindParamRequired||(!data&&this._cl_bindParamCallback!==null)){data=this._cl_bindParamCallback.call(this,r.params)}if(data!==null&&data!==undefined){r.receiver.receiveBindData.call(r.scope||r.receiver,this._cl_modifyBindData(data,r.mapping))}}}};mixin._cl_attachReceiver=function(receiver,params,mapping,scope){this._cl_receivers.push({receiver:receiver,params:params,mapping:mapping,scope:scope});this.notifyReceivers()};mixin._cl_detachReceiver=function(receiver){for(var i=0,l=this._cl_receivers.length;i<l;i++){var r=this._cl_receivers[i];if(r.receiver===receiver){this._cl_receivers.splice(i,1);break}}};mixin._cl_modifyBindData=function(dataSource,mapping){var data,isQuery=false;if(dataSource instanceof a5.cl.CLQueryResult){isQuery=true}if(isQuery){data=dataSource._cl_data}else{data=dataSource}if(mapping){var dataSet=[],skipProps={};for(var i=0,l=data.length;i<l;i++){var dataRow={};for(var prop in mapping){dataRow[prop]=data[i][mapping[prop]];skipProps[mapping[prop]]=prop}for(var prop in data[i]){if(skipProps[prop]===undefined){dataRow[prop]=data[i][prop]}}dataSet.push(dataRow)}if(isQuery){dataSource._cl_data=dataSet;return dataSource}else{return dataSet}}else{return dataSource}}});a5.Package("a5.cl.mixins").Mixin("Binder",function(mixin,im){this.Properties(function(){this._cl_bindingsConnected=true;this._cl_bindings=[]});mixin.Binder=function(){this._cl_bindings=[]};mixin.setBindingEnabled=function(value){if(value!==this._cl_bindingsConnected){for(var i=0,l=this._cl_bindings.length;i<l;i++){var b=this._cl_bindings[i];if(b.persist!==true){if(value){b.source._cl_attachReceiver(b.receiver,b.params,b.mapping,b.scope)}else{b.source._cl_detachReceiver(b.receiver)}}}this._cl_bindingsConnected=value}};mixin.bindingsConnected=function(){return this._cl_bindingsConnected};mixin.bind=function(source,receiver,params,mapping,scope,persist){if(!this._cl_checkBindExists(source,receiver,params)){if(source.isA5ClassDef()){source=source.instance()}if(!source.doesMix("a5.cl.mixins.BindableSource")){return this.throwError('source "'+source.className()+'" of bind call must mix a5.cl.mixins.BindableSource.')}if(receiver.isA5ClassDef()){receiver=receiver.instance()}if(!receiver.doesImplement("a5.cl.interfaces.IBindableReceiver")){return this.throwError('receiver "'+receiver.className()+'" of call bind must implement a5.cl.interfaces.IBindableReceiver.')}var hasParams=params!==undefined&&params!==null,isNM=false,pType=null;if(source.bindParamRequired()||params){var isValid=true;if(!hasParams){isValid=false}else{if(source.bindParamType()!==null){pType=source.bindParamType();if(typeof pType==="string"&&pType.indexOf(".")!==-1){pType=a5.GetNamespace(pType)}if(pType.namespace){isNM=true;var nmObj=pType.namespace();if(!(params instanceof pType)){isValid=false}}else{if(typeof params!==source.bindParamType()){isValid=false}}}}if(!isValid){this.throwError('params required for binding source "'+source.namespace()+'"'+(pType!==null?' must be of type "'+(isNM?pType.namespace():pType)+'"':""));return}}this._cl_bindings.push({source:source,scope:scope,receiver:receiver,mapping:mapping,params:params,persist:persist});if(this.bindingsConnected()){source._cl_attachReceiver(receiver,params,mapping,scope)}}};mixin.unbind=function(source,receiver){var found=false;for(var i=0,l=this._cl_bindings.length;i<l;i++){var obj=this._cl_bindings[i];if(obj.source===source&&obj.receiver===receiver){this._cl_bindings.splice(i,1);found=true;break}}if(found){source._cl_detachReceiver(receiver)}else{this.throwError('cannot unbind source "'+source.namespace()+'" on controller "'+this.namespace()+'", binding does not exist.')}};mixin._cl_checkBindExists=function(source,receiver,params){for(var i=0,l=this._cl_bindings.length;i<l;i++){var b=this._cl_bindings[i];if(b.source===source&&b.receiver===receiver&&b.params===params){return true}}return false}});a5.Package("a5.cl").Extends("CLBase").Prototype("CLService","abstract",function(proto,im){this.Properties(function(){this._cl_url=null;this._cl_isJson=true});proto.CLService=function(url){proto.superclass(this);this._cl_url=url};proto.url=function(){var plgn=this.plugins().getRegisteredProcess("serviceURLRewriter");if(plgn){return plgn.rewrite(this._cl_url)}return this._cl_url};proto.isJson=function(value){if(value!==undefined){this._cl_isJson=value}return this._cl_isJson}});a5.Package("a5.cl").Extends("a5.Attribute").Class("SerializableAttribute","abstract",function(cls){cls.SerializableAttribute=function(){}});a5.Package("a5.cl").Import("a5.cl.core.JSON").Extends("CLService").Static(function(CLSocket){CLSocket.supportsSockets=function(){return"WebSocket" in window?true:false}}).Prototype("CLSocket","abstract",function(proto,im,CLSocket){this.Properties(function(){this._cl_socket=null;this._cl_socketOnMessage=null});proto.CLSocket=function(url){proto.superclass(this,[url]);if(CLSocket.supportsSockets()){this._cl_socket=new WebSocket(url);var self=this;this._cl_socketOnMessage=function(e){var data=self.isJson()?im.JSON.parse(e.data):e.data;self.dataReceived(data)}}};proto.send=function(m,callback){if(CLSocket.supportsSockets()){var self=this;self._cl_socket.onmessage=self._cl_socketOnMessage;var sendMsg=function(){self._cl_socket.onopen=null;if(callback){self._cl_socket.onmessage=function(e){var data=self.isJson()?a5.cl.core.JSON.parse(e.data):e.data;callback(data);self._cl_socket.onmessage=self._cl_socketOnMessage}}self._cl_socket.send(m);return null};switch(this._cl_socket.readyState){case 0:this._cl_socket.onopen=sendMsg;break;case 1:sendMsg();break;case 2:this._cl_socket.onopen=sendMsg;this._cl_socket.connect();break}}else{throw"Error sending data to socket "+this.mvcName()+", Web Sockets are not supported in this browser."}};proto.dataReceived=function(data){};proto.close=function(){if(this._cl_socket){this._cl_socket.close()}};proto.dealloc=function(){if(this._cl_socket&&this._cl_socket.readyState===2){this.close()}}});a5.Package("a5.cl").Extends("CLService").Mix("a5.cl.mixins.BindableSource").Prototype("CLAjax","abstract",function(proto,im){this.Properties(function(){this._cl_ajaxStruct=null;this._cl_silent=false});proto.CLAjax=function(url,props){proto.superclass(this,[url]);this._cl_ajaxStruct=props};proto.call=function(m,data,callback,props){var callObj=this._cl_ajaxStruct?a5.cl.core.Utils.deepClone(this._cl_ajaxStruct):{};if(props){for(var prop in callObj){if(props[prop]==undefined){props[prop]=callObj[prop]}}}else{props=callObj}if(data){if(data.isA5Class){props.data=a5.Attribute.processInstance(data)}props.data=data}props.isJson=this.isJson();props.success=callback;if(this._cl_silent){props.silent=true}if(m){if(this.url().indexOf("?")==-1&&m.charAt(0)!=="/"){m="/"+m}}else{m=""}props.url=this.url()+m;return a5.cl.core.RequestManager.instance().makeRequest(props)};proto.abort=function(id){return a5.cl.core.RequestManager.instance().abort(id)};proto.silent=function(value){if(typeof value==="boolean"){this._cl_silent=value;return this}return this._cl_silent}});a5.Package("a5.cl").Extends("a5.AspectAttribute").Static(function(AjaxCallAttribute){AjaxCallAttribute.CANCEL_CYCLE="ajaxCallAttributeCancelCycle"}).Class("AjaxCallAttribute",function(cls,im,AjaxCallAttribute){var cycledCalls={},data={};cls.AjaxCallAttribute=function(){cls.superclass(this)};cls.Override.before=function(aspectArgs){var data=null,args=aspectArgs.args()?Array.prototype.slice.call(aspectArgs.args()):[];argsCallback=null,rules=aspectArgs.rules().length?aspectArgs.rules()[0]:{},propObj=null;if(rules.takesData===true&&args.length){data=args.shift()}if(rules.props){propObj=rules.props}if(rules.hasErrorCallback){if(!propObj){propObj={}}propObj.error=args.pop()}if(rules.hasCallback===true&&args.length&&typeof args[0]==="function"){argsCallback=args.shift()}var executeCall=function(){if(rules.cacheResponse&&getData(aspectArgs.method())){setTimeout(function(){args.unshift(getData(aspectArgs.method()));if(argsCallback){argsCallback(args)}aspectArgs.callback()(args)},0)}else{aspectArgs.scope().call(aspectArgs.method().getName(),data,function(response){if(rules.cacheResponse){storeData(aspectArgs.method(),response)}args.unshift(response);if(argsCallback){argsCallback(args)}aspectArgs.callback()(args)},propObj)}};if(args[0]===AjaxCallAttribute.CANCEL_CYCLE){if(aspectArgs.method()._cl_cycleID){clearInterval(aspectArgs.method()._cl_cycleID);delete aspectArgs.method()._cl_cycleID}return a5.Attribute.ASYNC}if(rules.cycle){if(!aspectArgs.method()._cl_cycleID){aspectArgs.method()._cl_cycleID=setInterval(function(){aspectArgs.method().apply(aspectArgs.scope(),args)},rules.cycle);executeCall()}else{executeCall()}}else{executeCall()}return a5.Attribute.ASYNC};var getData=function(method){return data[method.getClassInstance().instanceUID()+"_"+method.getName()]};var storeData=function(method,value){data[method.getClassInstance().instanceUID()+"_"+method.getName()]=value}});a5.Package("a5.cl").Extends("a5.AspectAttribute").Class("BoundAjaxReturnAttribute",function(cls){cls.BoundAjaxReturnAttribute=function(){cls.superclass(this)};cls.Override.before=function(aspectArgs){if(aspectArgs.rules().length&&aspectArgs.rules()[0].receiverMethod!==undefined){aspectArgs.rules()[0].receiverMethod.call(null,aspectArgs.args()[0])}else{aspectArgs.scope().notifyReceivers(aspectArgs.args()[0],aspectArgs.method().getName())}return a5.AspectAttribute.SUCCESS}});a5.Package("a5.cl").Extends("CLBase").Prototype("CLPlugin","abstract",function(proto,im){this.Properties(function(){this._cl_pluginConfig=null;this._cl_configDefaults={};this._cl_requiredVersion="0";this._cl_maxVerifiedVersion=null;this._cl_requires=[]});proto.CLPlugin=function(){proto.superclass(this)};proto.pluginConfig=function(){return this._cl_pluginConfig};proto.requires=function(val){this._cl_requires.push(val)};proto.requiredVersion=function(value){if(value!==undefined){this._cl_requiredVersion=value}return this._cl_requiredVersion};proto.maxVerifiedVersion=function(value){if(value!==undefined){this._cl_maxVerifiedVersion=value}return this._cl_maxVerifiedVersion};proto.configDefaults=function(value){if(value!==undefined){this._cl_configDefaults=value}return this._cl_configDefaults};proto.initializePlugin=function(){};proto.registerForProcess=function(type){this.cl()._core().pluginManager().registerForProcess(type,this)};proto._cl_sourceConfig=function(){var cfg=a5.cl.CLMain._cl_storedCfgs.pluginConfigs;var pkg=this.classPackage();if(String(pkg[pkg.length-1]).toLowerCase()!=this.className().toLowerCase()){pkg=pkg+"."+this.constructor.className()}for(var prop in cfg){var pluginCfg=cfg[prop];if(pluginCfg.nm&&(pluginCfg.nm===pkg||pluginCfg.nm===this.constructor.className())){return pluginCfg.obj}}return{}}});a5.Package("a5.cl").Extends("CLPlugin").Prototype("CLAddon","abstract",function(proto,im,CLAddon){CLAddon.INITIALIZE_COMPLETE="clAddonInitializeComplete";proto.CLAddon=function(){proto.superclass(this)};proto.initializeAddOn=function(){return false};proto.createMainConfigMethod=function(type){a5.cl.CLMain.prototype["set"+type.substr(0,1).toUpperCase()+type.substr(1)]=function(){a5.cl.CLMain._cl_storedCfgs[type]=Array.prototype.slice.call(arguments)}};proto.getMainConfigProps=function(type){return a5.cl.CLMain._cl_storedCfgs[type]};proto.registerAutoInstantiate=function(){a5.cl.core.Instantiator.instance().registerAutoInstantiate.apply(null,arguments)};proto.defineRegisterableProcess=function(process){this.cl()._core().pluginManager().defineRegisterableProcess(process)}});a5.Package("a5.cl").Extends("CLBase").Mix("a5.cl.mixins.Binder").Class("CL","singleton",function(cls,im){var _params,_initializer,_config,core;cls._cl_plugins={};cls.CL=function(params,initializer){cls.superclass(this);var main=cls.create(a5.cl.CLMain._extenderRef[0],[params]);_params=main._cl_params();_initializer=initializer;core=cls.create(a5.cl.core.Core,[_params]);_config=a5.cl.core.Utils.mergeObject(core.instantiator().instantiateConfiguration(),params);if(_config.breakOnDestroyedMethods==true){a5._a5_destroyedObjFunc=Function("debugger;")}};cls._cl_launch=function(){core.initializeCore((_params.environment||null),(_params.clientEnvironment||null))};cls.initializer=function(){return _initializer};cls.Override.config=function(){return _config};cls.launchState=function(){return core.launchState()};cls.applicationBuild=function(){return config.applicationBuild};cls.appName=function(){return config.appName};cls.applicationPackage=function(){return core.instantiator().applicationPackage.apply(cls,arguments)};cls.Override.appParams=function(){return a5.cl.CLMain._cl_storedCfgs.appParams};cls.environment=function(){return config.environment};cls.Override.plugins=function(){return cls._cl_plugins};cls.relaunch=function(){core.relaunch()};cls._core=function(){return core};cls.asyncRunning=function(){return core.requestManager().asyncRunning()};cls.Override.eListenersChange=function(e){var ev=a5.cl.CLEvent.GLOBAL_UPDATE_TIMER_TICK;if(e.type===ev){if(cls.getTotalListeners(ev)>0){core.globalUpdateTimer().startTimer()}else{core.globalUpdateTimer().stopTimer()}}}});a5.Package("a5.cl").Extends("CLBase").Static(function(CLMain){CLMain._cl_storedCfgs={appParams:{},pluginConfigs:[]}}).Prototype("CLMain","abstract",function(proto,im,CLMain){var configDefaults={allowUntestedPlugins:false,applicationBuild:null,appName:"",breakOnDestroyedMethods:false,cacheEnabled:true,dependencies:[],environment:"DEVELOPMENT",globalUpdateTimerInterval:10,requestDefaultContentType:"application/json",requestDefaultMethod:"POST"},_params;proto.CLMain=function(params){proto.superclass(this);if(CLMain._extenderRef.length>1){return proto.throwError(proto.create(a5.cl.CLError,['Invalid class "'+this.namespace()+'", a5.cl.CLMain must only be extended by one subclass.']))}if(this.getStatic().instanceCount()>1){return proto.throwError(proto.create(a5.cl.CLError,['Invalid duplicate instance of a5.cl.CLMain subclass "'+this.getStatic().namespace()+'"']))}for(var prop in configDefaults){if(params[prop]===undefined){params[prop]=configDefaults[prop]}}_params=params;_params.applicationPackage=this.classPackage();proto.cl().addOneTimeEventListener(im.CLEvent.APPLICATION_WILL_RELAUNCH,this.applicationWillRelaunch);proto.cl().addEventListener(im.CLEvent.ONLINE_STATUS_CHANGE,this.onlineStatusChanged);proto.cl().addOneTimeEventListener(im.CLEvent.APPLICATION_CLOSED,this.applicationClosed);proto.cl().addOneTimeEventListener(im.CLEvent.DEPENDENCIES_LOADED,this.dependenciesLoaded);proto.cl().addOneTimeEventListener(im.CLEvent.PLUGINS_LOADED,this.pluginsLoaded);proto.cl().addOneTimeEventListener(im.CLEvent.AUTO_INSTANTIATION_COMPLETE,this.autoInstantiationComplete);proto.cl().addOneTimeEventListener(im.CLEvent.APPLICATION_WILL_LAUNCH,this.applicationWillLaunch);proto.cl().addOneTimeEventListener(im.CLEvent.APPLICATION_LAUNCHED,this.applicationLaunched)};proto.allowUntestedPlugins=function(val){_params.allowUntestedPlugins=val};proto.appName=function(val){_params.appName=val};proto.breakOnDestroyedMethods=function(val){_params.breakOnDestroyedMethods=val};proto.cacheEnabled=function(val){_params.cacheEnabled=val};proto.dependencies=function(val){_params.dependencies=val};proto.environment=function(val){_params.environment=val};proto.globalUpdateTimerInterval=function(val){_params.globalUpdateTimerInterval=val};proto.requestDefaultContentType=function(val){_params.requestDefaultContentType=val};proto.requestDefaultMethod=function(val){_params.requestDefaultMethod=val};proto._cl_params=function(){return _params};proto.setAppParams=function(obj){CLMain._cl_storedCfgs.appParams=obj};proto.setPluginConfig=function(namespace,obj){CLMain._cl_storedCfgs.pluginConfigs.push({nm:namespace,obj:obj})};proto.dependenciesLoaded=function(){};proto.pluginsLoaded=function(){};proto.onlineStatusChanged=function(isOnline){};proto.autoInstantiationComplete=function(){};proto.applicationWillLaunch=function(){};proto.applicationLaunched=function(){};proto.applicationWillClose=function(){};proto.applicationClosed=function(){};proto.applicationWillRelaunch=function(){}})})(this);a5.Package("a5.cl.initializers.dom").Extends("a5.cl.CLPlugin").Implements("a5.cl.interfaces.IDataCacheProvider").Class("DataCache","singleton final",function(b,a){var d,c;this.DataCache=function(){b.superclass(this);b.registerForProcess("dataCacheProvider");d=window.localStorage!=undefined;c=(b.isAvailable()&&localStorage.length)?true:false};this.isAvailable=function(){return a5.cl.core.DataCache.enabled()&&d};this.cacheExists=function(){if(this.isAvailable()){return c}else{return false}};this.storeValue=function(f,g){var e=a5.cl.core.JSON.stringify(g);return localStorage.setItem(f,e)};this.getValue=function(f){try{var h=localStorage.getItem(f);return a5.cl.core.JSON.parse(h)}catch(g){return null}};this.clearValue=function(f){try{return localStorage.removeItem(f)}catch(g){return false}};this.clearScopeValues=function(p,n){var e=n||[],h,g;for(var h=0,f=localStorage.length;h<f;h++){var o=localStorage.key(h);if(o.indexOf(p)==0){var q=o.split(p)[1].substr(1),k=false;for(g=0,m=e.length;g<m;g++){if(q==e[g]){k=true}}if(!k){localStorage.removeItem(o);h--;f=localStorage.length}}}}});a5.Package("a5.cl.initializers.dom").Import("a5.cl.CLEvent").Extends("a5.cl.CLBase").Class("EnvManager","singleton final",function(p,j){var o,q,k,r,g,d,t,w,s,v,y;this.environment=function(){return t};this.clientPlatform=function(){return r};this.clientOrientation=function(){return g};this.clientEnvironment=function(){return k};this.browserVersion=function(){return d};this.isOnline=function(){return q};this.isLocal=function(){return s};this.appPath=function(z){return z?y:v};this.EnvManager=function(B,C){p.superclass(this);q=true;o=!!document.createElement("canvas").getContext;g=f();if(C){k=C}else{if(p.config().clientEnvironment){k=p.config().clientEnvironment}else{k=c()}}b();a();if(B){t=B}else{t=p.config().environment}var z=x(t,p.config().environments);if(z){a5.cl.core.Utils.mergeObject(z,p.config(),true)}var A=x(k,p.config().clientEnvironments);if(A){a5.cl.core.Utils.mergeObject(A,p.config(),true)}s=window.location.protocol=="file:";n()};this.initialize=function(){u();try{document.body.addEventListener("online",h);document.body.addEventListener("offline",h)}catch(z){}};var h=function(){if(navigator.onLine!==undefined){var z=navigator.onLine;if(z!=q){q=z;a5.cl.instance().dispatchEvent(j.CLEvent.ONLINE_STATUS_CHANGE,{online:p.isOnline()})}}};var c=function(){if("runtime" in window){return"AIR"}else{if("connection" in window&&"notification" in window&&"contacts" in window){return"PHONEGAP"}else{var A=e(),z=A&&screen.width>=p.config().mobileWidthThreshold;w=window.blackberry!=undefined;if(w){A=true}if(z){return"TABLET"}else{if(A){return"MOBILE"}else{return"DESKTOP"}}}}};var e=function(){if(window.orientation!==undefined){return true}var A=["ontouchstart"];var C=document.createElement("div");for(var B=0,z=A.length;B<z;B++){C.setAttribute(A[B],"return;");if(typeof C[A[B]]==="function"){return true}}C=null;if(navigator.userAgent.toLowerCase().match(/mobile/i)){return true}return false};var b=function(){if(w){if(o){r="BB6"}else{r="BB"}}else{if(navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)){r="IOS"}else{if(navigator.userAgent.match(/Android/i)){r="ANDROID"}else{if(navigator.userAgent.match(/IEMobile/i)){r="WP7"}else{if(window.ActiveXObject){r="IE"}}}}}if(!r){r="UNKNOWN"}};var f=function(){if(typeof window.orientation!=="undefined"){return(window.orientation==0||window.orientation===180)?"PORTRAIT":"LANDSCAPE"}else{return"UNKNOWN"}};var x=function(F,D){var I=[],z,J,H,G,E,C,K,B,A=null;for(z in D){H=true;G=z;if(G.charAt(0)==="_"){H=false;G=G.substr(1)}J=G.split("_");K=false;B=true;for(E=0,C=J.length;E<C;E++){if(H){if(J[E]===F){K=true;break}}else{if(J[E]===F){B=false}break}}if((H&&K)||(!H&&B)){I.push(D[z])}}if(I.length){A=I[0]}if(I.length>1){for(E=1,C=I.length;E<C;E++){a5.cl.core.Utils.mergeObject(I[E],A,true)}}return A};var a=function(){d=0;if(document.body.style.scrollbar3dLightColor!=undefined){if(document.body.style.opacity!=undefined){d=9}else{if(!p.config().forceIE7&&document.body.style.msBlockProgression!=undefined){d=8}else{if(document.body.style.msInterpolationMode!=undefined){d=7}else{if(document.body.style.textOverflow!=undefined){d=6}else{d=5.5}}}}}};var n=function(){var z=window.location.pathname;if(z.indexOf(".")!=-1){z=z.substr(0,z.lastIndexOf("/")+1)}y=window.location.protocol+"//"+window.location.host;v=y+z;if(v.charAt(v.length-1)!="/"){v+="/"}};var u=function(){window.onbeforeunload=function(){p.cl().dispatchEvent(j.CLEvent.APPLICATION_WILL_CLOSE)};window.onunload=function(){p.cl().dispatchEvent(j.CLEvent.APPLICATION_CLOSED)};if(p.config().trapErrors===true){window.onerror=function(D,B,A){D=D||window.error;if(D==="Script error."){D="Cannot discern error data from window.onerror - Possible cause is loading A5 from a cross domain source.\nTry disabling trapErrors to use the console or load a local copy of A5."}var C=a5._a5_getThrownError();if(C&&D!==""&&D.indexOf(C.toString())!==-1){D=C}else{D=a5.Create(a5.Error,[D,false])}if(B){D.url=B}if(A){D.line=A}p.cl().dispatchEvent(j.CLEvent.ERROR_THROWN,D);return false}}var z=("onorientationchange" in window)?"onorientationchange":"onresize";window[z]=function(){p.cl().dispatchEvent(j.CLEvent.WINDOW_RESIZED);var A=f();if(A!==g){g=A;if(k==="MOBILE"||k==="TABLET"){p.cl().dispatchEvent(j.CLEvent.ORIENTATION_CHANGED)}}};if(z!=="onresize"){window.onresize=function(){p.cl().dispatchEvent(j.CLEvent.WINDOW_RESIZED)}}}});a5.Package("a5.cl.initializers.dom").Import("a5.cl.CLEvent").Extends("a5.cl.CLBase").Mix("a5.cl.mixins.DataStore").Static(function(a){a.BROWSER_CACHED_ENTRY="clResourceCacheBrowserCacheEntry";a.COMBINED_DEPENDENCY="clResourceCacheCombinedDependcy";a._cl_delimiterOpen="<!--CL:";a._cl_delimiterClose=":CL-->"}).Class("ResourceCache","singleton final",function(r,n,o){var e,f,d,h,b,k=[{type:"html",extension:"html"},{type:"html",extension:"htm"},{type:"js",extension:"js"},{type:"text",extension:"txt"},{type:"image",extension:"jpg"},{type:"image",extension:"gif"},{type:"image",extension:"png"},{type:"css",extension:"css"},{type:"xml",extension:"xml"}];this.ResourceCache=function(){this.superclass(this);r.cl().addOneTimeEventListener(n.CLEvent.CORE_LOADED,a);e={}};var a=function(){h=a5.cl.core.RequestManager.instance();k=k.concat(r.config().cacheTypes);if(r.config().cacheBreak&&typeof r.config().applicationBuild==="string"){var s=n.Utils.trim(r.config().applicationBuild);if(s!==""){b=s}}};this.initStorageRules=function(){var t=this.cl().manifestBuild(),s=this.getValue("build")||-1;d=(this.cl().isOfflineCapable()&&this.cl().environment()==="PRODUCTION");if(t&&t>s){this.clearScopeValues()}if(d){this.storeValue("build",t)}else{this.clearScopeValues()}};this.load=function(D,E,t,C,u){var x=[],B,z=0,F,y,u=u||false,v;if(typeof D=="string"){x.push(D);B=null}else{x=D;B=[]}a5._a5_delayProtoCreation(true);F=x.length;y=100/F;if(r.config().staggerDependencies||r.config().xhrDependencies||u){s(x[z])}else{for(var A=0,w=x.length;A<w;A++){s(x[A])}}function s(N){var H=null;var S=null;if(N!=undefined){if(typeof N=="string"){H=N;S=c(H)}else{H=N[0];S=N[1]}}function K(W){a5._a5_createQueuedPrototypes();a5._a5_verifyPackageQueueEmpty();a5._a5_delayProtoCreation(false);if(E){E(W)}}function I(X){z++;var W=Math.floor((z/F)*100);if(t){t({loadCount:z,totalItems:F,data:X,itemURL:H,itemType:S,percent:W})}if(F==1){B=X}else{B.push(X)}if(r.config().staggerDependencies||r.config().xhrDependencies||u){if(z==F){K(B)}else{s(x[z])}}else{if(z===x.length){K(B)}}}var V=p(H);if(!V){if(S){H=n.Utils.makeAbsolutePath(g(H));if(b){H=H+"?a5="+b}if(S==="css"){var R=function(){if(C){C(H)}else{r.throwError("Error loading css resource at url "+H)}},L=document.getElementsByTagName("head")[0],M=document.createElement("link");M.onerror=R;M.href=H;M.rel="stylesheet";M.media="screen";L.appendChild(M);q(H,S,o.BROWSER_CACHED_ENTRY);I();M=L=null}else{if(S==="image"){var P=new Image(),U=function(){a5.cl.mvc.core.GarbageCollector.instance().destroyElement(P);P=null;q(H,S,o.BROWSER_CACHED_ENTRY);I()},O=function(){if(C){C(H)}else{r.redirect(500,"Error loading image resource at url "+H)}};P.onload=U;P.onerror=O;P.src=data}else{if(S==="js"&&r.config().xhrDependencies===false&&u==false){var Q=function(){T.insertBefore(G,T.firstChild)};var T=document.getElementsByTagName("head")[0],G=document.createElement("script");G.type="text/javascript";G.src=H;if(G.readyState){G.onreadystatechange=function(){if(this.readyState=="loaded"||this.readyState=="complete"){I()}}}else{G.onload=I}Q()}else{var J={url:H,method:"GET",contentType:"text/plain",success:function(W){W=q(H,S,W);j(H,W,S,function(){I(W)})},error:function(){if(C){C(H)}else{r.redirect(500,"Error loading resource at url "+H)}}};if(typeof t==="function"){J.progress=function(W){t({loadCount:z,totalItems:F,itemURL:H,itemType:S,percent:Math.floor(y*z+y*Math.floor(W.loaded/W.total))})}}J.silent=r.config().silentIncludes===true;h.makeRequest(J)}}}}else{throw'Unknown include type for included file "'+H+'".'}}else{if(V===o.BROWSER_CACHED_ENTRY){I(null)}else{I(V)}}}};this.getCachedHTML=function(v,u){var t=e[v];if(t&&t.isID&&t.type==="html"){var s=document.createDocumentFragment();s.innerHTML=t.data;return s}return null};this.purgeAllCaches=function(s){if(window.localStorage!==undefined){localStorage.clear()}r.cl().purgeApplicationCache(s)};this.combineMarkupResources=function(){var t="";for(var u in e){var s=e[u];if(s.type==="xml"||s.type==="html"){t+=o._cl_delimiterOpen+" ";t+=(s.isID?"id=":"url=")+u;t+=" type="+s.type;t+=" "+o._cl_delimiterClose+"\n\n";t+=s.data+"\n\n"}}return t};var p=function(s){var u=e[s],t=(typeof u==="object");if(!u&&d&&u!==o.BROWSER_CACHED_ENTRY&&u!==o.COMBINED_DEPENDENCY){u=r.getValue(s)}return(t?u.data:null)};var q=function(w,v,J,s,H){J=a5.cl.core.Utils.trim(J);var u=new RegExp(o._cl_delimiterOpen+".*?"+o._cl_delimiterClose,"g");if(u.test(J)){if(J.indexOf(o._cl_delimiterOpen)!==0){r.throwError("Error parsing combined resource: "+w+"\n\nCombined XML and HTML resources must start with a delimiter");return}var F,A=[];u.lastIndex=0;while(F=u.exec(J)){A.push({index:u.lastIndex,match:a5.cl.core.Utils.trim(F[0])})}for(var E=0,G=A.length;E<G;E++){var K=A[E],I=J.substring(K.index,(E<G-1)?A[E+1].index:J.length).replace(u,""),B=K.match.replace(o._cl_delimiterOpen,"").replace(o._cl_delimiterClose,""),t=a5.cl.core.Utils.trim(B).split(" "),L={};for(var D=0,M=t.length;D<M;D++){var N=t[D].split("="),z=N.length>1?N[0]:"url",C=N.pop();L[z]=C}if(L.url){L.url=a5.cl.core.Utils.makeAbsolutePath(L.url)}q(L.url||L.id,L.type||v,I,false,!L.url)}q(w,v,o.COMBINED_DEPENDENCY);return null}else{e[w]={type:v,data:J,isID:H===true};if(d&&!s){r.storeValue(w,J)}return J}};var c=function(u){var t=u.split("."),w=t[t.length-1].replace(/\?.*$/,"");for(var v=0,s=k.length;v<s;v++){if(typeof k[v]!="object"||k[v].extension==undefined||k[v].type==undefined){throw"Improper config cacheType specified: "+k[v].toString()}else{if(w==k[v].extension){return k[v].type}}}return null};var j=function(t,x,w,z){switch(w){case"js":try{var v=function(){u.insertBefore(s,u.firstChild)};var u=document.getElementsByTagName("head")[0],s=document.createElement("script");s.type="text/javascript";try{s.appendChild(document.createTextNode(x))}catch(y){s.text=x}finally{v();z()}}catch(y){r.throwError(y)}finally{s=u=null}break;case"html":case"xml":default:z()}};var g=function(s){var t=r.cl().initializer().environmentManager();return s.replace("{CLIENT_ENVIRONMENT}",t.clientEnvironment()).replace("{ENVIRONMENT}",t.environment())}});a5.Package("a5.cl.initializers.dom").Extends("a5.cl.CLBase").Class("ManifestManager","singleton final",function(d){var f,c,g=null,e;this.ManifestManager=function(){d.superclass(this);e=document.getElementsByTagName("html")[0].getAttribute("manifest");c=window.applicationCache;f=c&&e?true:false;if(f){b()}};this.manifestBuild=function(){return g};this.isOfflineCapable=function(){return f};this.purgeApplicationCache=function(k){var j=(k==false?false:true);var n=function(){c.swapCache();if(j){d.cl().relaunch(true)}};if(c.status==1){c.addEventListener("updateready",n,false);c.update()}else{throw"Cannot purge application cache, appCache status is "+c.status}};var b=function(){h(e);c.addEventListener("error",a,false)};var h=function(k){var n=a5.cl.core.ResourceCache.instance(),j;d.cl().include(k,function(o){j=o.match(/#build\b.[0-9]*/);if(j){j=j[0];j=j.split("#build")[1];j=parseInt(a5.cl.core.Utils.trim(j));if(!isNaN(j)){g=j}}})};var a=function(j){d.redirect(500,"Error loading manifest")}});a5.Package("a5.cl.initializers.dom").Import("a5.cl.CLEvent").Extends("a5.cl.CLInitializer").Class("DOMInitializer",function(b,a){var d,e;b.DOMInitializer=function(){b.superclass(this)};b.environmentManager=function(){return e};b.resourceCache=function(){return d};b.Override.load=function(f,g,h){return d.load(f,g,h)};b.Override.initialize=function(f,k){var h=false,g=function(){if(!h){h=true;k()}},j=function(){if(document.addEventListener){document.removeEventListener("DOMContentLoaded",j,false);g()}else{if(document.attachEvent){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",j);g()}}}};if(document.readyState==="complete"){g()}else{if(document.addEventListener){document.addEventListener("DOMContentLoaded",j,false)}else{if(document.attachEvent){document.attachEvent("onreadystatechange",j)}}}};b.Override.applicationInitialized=function(f){f.addOneTimeEventListener(a.CLEvent.APPLICATION_PREPARED,c);d=b.create(a.ResourceCache);e=b.create(a.EnvManager,[f.config().environment,f.config().clientEnvironment])};var c=function(){e.initialize()}});a5.Package("a5.cl.initializers.dom").Static("Utils",function(a){a.vendorPrefixes=["-webkit-","-moz-","-ms-","-o-"];a.jsVendorPrefixes=["Webkit","Moz","ms","o"];a.jsVendorMethodPrefixes=["webkit","moz","ms","o"];a.purgeBody=function(){var b=document.getElementsByTagName("body")[0];b.innerHTML="";b.style.margin="0px"};a.getParameterByName=function(c){var b=RegExp("[?&]"+c+"=([^&]*)").exec(window.location.search);return b&&decodeURIComponent(b[1].replace(/\+/g," "))};a.isAbsolutePath=function(b){return(b.indexOf("://")!==-1||b.substr(0,1)=="/")};a.makeAbsolutePath=function(b){return a.isAbsolutePath(b)?(b.substr(0,1)=="/"?a5.cl.instance().initializer().environmentManager().appPath(true)+b:b):(a5.cl.instance().initializer().environmentManager().appPath()+b)};a.generateSystemHTMLTemplate=function(c,f,e){var d='<div style="margin:0px auto;text-align:center;font-family:Arial;"><h1>A5 CL: '+c+' Error</h1>				<div style="text-align:left;margin-bottom:50px;">'+f+"</div></div>";if(e){var b=document.getElementsByTagName("body")[0];if(b){b.innerHTML=d}else{throw f}}return d};a.addEventListener=function(e,c,d,b){var c=c.indexOf("on")===0?c.substr(2):c,b=b||false;if(typeof e.addEventListener==="function"){e.addEventListener(c,d,b)}else{e.attachEvent("on"+c,d)}};a.removeEventListener=function(e,c,d,b){var c=c.indexOf("on")===0?c.substr(2):c;if(typeof e.addEventListener==="function"){e.removeEventListener(c,d,b)}else{e.detachEvent("on"+c,d)}};a.getVendorWindowMethod=function(d){var g=null,c,b,f,e=/-/g;while(e.test(d)){d=d.substring(0,e.lastIndex-1)+d.substr(e.lastIndex,1).toUpperCase()+d.substr(e.lastIndex+1);e.lastIndex=0}for(c=0,b=a.jsVendorMethodPrefixes.length;c<=b;c++){f=c===b?d:(a.jsVendorMethodPrefixes[c]+d.substr(0,1).toUpperCase()+d.substr(1));if(typeof window[f]==="function"){g=window[f];break}}return g};a.getCSSProp=function(d){var f=document.createElement("div"),h=null,c,b,g,e=/-/g;while(e.test(d)){d=d.substring(0,e.lastIndex-1)+d.substr(e.lastIndex,1).toUpperCase()+d.substr(e.lastIndex+1);e.lastIndex=0}for(c=0,b=a.jsVendorPrefixes.length;c<=b;c++){g=c===b?d:(a.jsVendorPrefixes[c]+d.substr(0,1).toUpperCase()+d.substr(1));if(h===null&&typeof f.style[g]==="string"){h=g;break}}f=null;return h};a.getVendorCSSValue=function(h,e){var d=document.createElement("div"),c=e,b,g,f;for(b=0,g=a.vendorPrefixes.length;b<=g;b++){f=(b===0?"":a.vendorPrefixes[b-1])+e;d.style[h]=f;if(d.style[h]===f){c=f;break}}d=null;return c};a.setVendorCSS=function(d,g,e,c){c=c===true;d.style.setProperty(g,e,null);for(var b=0,f=a.vendorPrefixes.length;b<f;b++){d.style.setProperty((c?"":a.vendorPrefixes[b])+g,(c?a.vendorPrefixes[b]:"")+e,null)}};a.elementInDocument=function(b){while(b){if(b===document){return true}b=b.parentNode}return false}});a5.Package("a5.cl.initializers.dom").Extends("a5.cl.CLAddon").Class("DOM","singleton",function(c,b,d){var a;c.DOM=function(){c.superclass(this);c.configDefaults({cacheBreak:false,cacheTypes:[],clientEnvironment:null,clientEnvironmentOverrides:false,mobileWidthThreshold:768,silentIncludes:false,staggerDependencies:true,titleDelimiter:": ",trapErrors:false,xhrDependencies:false})};c.Override.initializePlugin=function(){a=c.create(b.ManifestManager)};c.manifestManager=function(){return c.cl().initializer().manifestManager()};c.environmentManager=function(){return envManager};c.appPath=function(e){return envManager.appPath(e)};c.browserVersion=function(){return envManager.browserVersion()};c.clientEnvironment=function(){return envManager.clientEnvironment.apply(null,arguments)};c.clientPlatform=function(){return envManager.clientPlatform()};c.clientOrientation=function(){return envManager.clientOrientation()};c.environment=function(){return envManager.environment()};c.isOfflineCapable=function(){return a.isOfflineCapable()};c.isLocal=function(){return envManager.isLocal()};c.isOnline=function(){return envManager.isOnline()}});a5.Create(a5.cl.initializers.dom.DOMInitializer);